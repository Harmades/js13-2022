function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},r={},a=n.parcelRequired7fa;function o(e){return Math.round(e)}function s(e){return Math.floor(e)}function l(e){return Math.abs(e)}function d(e,t){return Math.min(e,t)}function u(e){return Math.cos(e)}function h(e){return Math.sin(e)}function p(e,t){return Math.pow(e,t)}function c(e){return document.getElementById(e)}null==a&&((a=function(e){if(e in i)return i[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},n.parcelRequired7fa=a),a.register("dRo73",(function(t,n){var i,r;e(t.exports,"register",(()=>i),(e=>i=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var a={};i=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)a[t[n]]=e[t[n]]},r=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a("dRo73").register(JSON.parse('{"1MGML":"index.c0fad60d.js","fnLwo":"texture.bca4a932.png"}'));const y=Math.PI;var f;f=JSON.parse('{"frames":{"assets/boss.png":{"frame":{"x":0,"y":0,"w":28,"h":38},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":28,"h":38},"sourceSize":{"w":28,"h":38},"pivot":{"x":0.5,"y":0.5}},"assets/boss2.png":{"frame":{"x":28,"y":0,"w":29,"h":38},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":29,"h":38},"sourceSize":{"w":29,"h":38},"pivot":{"x":0.5,"y":0.5}},"assets/shield.png":{"frame":{"x":0,"y":38,"w":28,"h":28},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":28,"h":28},"sourceSize":{"w":28,"h":28},"pivot":{"x":0.5,"y":0.5}},"assets/cerbere.png":{"frame":{"x":28,"y":38,"w":20,"h":17},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":17},"sourceSize":{"w":20,"h":17},"pivot":{"x":0.5,"y":0.5}},"assets/cerbere2.png":{"frame":{"x":57,"y":0,"w":20,"h":18},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":18},"sourceSize":{"w":20,"h":18},"pivot":{"x":0.5,"y":0.5}},"assets/friendly_vertical_laser.png":{"frame":{"x":48,"y":38,"w":7,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":16},"sourceSize":{"w":7,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/border2.png":{"frame":{"x":28,"y":55,"w":16,"h":11},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":5,"w":16,"h":11},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/basic_cobble.png":{"frame":{"x":57,"y":18,"w":16,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":16,"h":16},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/vertical_laser.png":{"frame":{"x":55,"y":38,"w":7,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":16},"sourceSize":{"w":7,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/skeleton.png":{"frame":{"x":62,"y":34,"w":13,"h":16},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":1,"y":0,"w":13,"h":16},"sourceSize":{"w":15,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/border1.png":{"frame":{"x":0,"y":66,"w":16,"h":14},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":2,"w":16,"h":14},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/basic_cobble2.png":{"frame":{"x":44,"y":55,"w":16,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":16,"h":16},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/imp.png":{"frame":{"x":62,"y":50,"w":10,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":10,"h":16},"sourceSize":{"w":10,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/zombie.png":{"frame":{"x":73,"y":18,"w":11,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":11,"h":16},"sourceSize":{"w":11,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/power_up_shot.png":{"frame":{"x":16,"y":66,"w":14,"h":12},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":2,"y":3,"w":14,"h":12},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/floating_eye.png":{"frame":{"x":30,"y":66,"w":14,"h":13},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":14,"h":13},"sourceSize":{"w":14,"h":13},"pivot":{"x":0.5,"y":0.5}},"assets/power_up_multi_shot.png":{"frame":{"x":60,"y":66,"w":9,"h":13},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":1,"w":9,"h":13},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/power_up_shield.png":{"frame":{"x":77,"y":0,"w":10,"h":12},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":2,"w":10,"h":12},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/friendly_vertical_laser_top.png":{"frame":{"x":77,"y":12,"w":7,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":5},"sourceSize":{"w":7,"h":5},"pivot":{"x":0.5,"y":0.5}},"assets/vertical_laser_top.png":{"frame":{"x":44,"y":71,"w":7,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":5},"sourceSize":{"w":7,"h":5},"pivot":{"x":0.5,"y":0.5}},"assets/friendly_bullet.png":{"frame":{"x":51,"y":71,"w":5,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":5,"h":5},"sourceSize":{"w":5,"h":5},"pivot":{"x":0.5,"y":0.5}},"assets/enemie_bullet.png":{"frame":{"x":75,"y":34,"w":5,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":5,"h":5},"sourceSize":{"w":5,"h":5},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":87,"h":80},"scale":1}}');var x;x=new URL(a("dRo73").resolve("fnLwo"),import.meta.url).toString();const m={debug:!1,width:1200,height:576,worldWidth:400,worldHeight:192,tileSize:16,worldTileWidth:25,worldTileHeight:12,playerSpeedX:100,playerSpeedY:100,playerWidth:15,playerHeight:14,playerOx:3,playerOy:3,playerBulletSpeedX:200,playerBulletSpeedY:100,playerBulletsPoolSize:200,playerSprayOpen:1.2,playerBulletWidth:3,playerBulletHeight:3,playerInvincibleTime:.8,playerBlinkPeriod:.1,playerAnimationTime:.2,enemyWidth:13,enemyHeight:16,enemyOx:0,enemyOy:0,enemyBulletSpeedX:150,enemyBulletSpeedY:50,enemyBulletsPoolSize:50,enemyShootFrequency:1,enemyBulletPoolSize:1e3,enemySprayOpen:1,bossWidth:22,bossHeight:33,bossOx:6,bossOy:3,bossSpeed:300,bossBulletSpeedX:100,bossBulletSpeedY:100,bossBulletsPoolSize:200,bossBigBulletWidth:25,bossBigBulletHeight:25,bossBigBulletExplosionTick:200,bossPatternFrequency:5,bossSprayOpen:2,bossLife:100,bulletWidth:3,bulletHeight:3,bulletOx:1,bulletOy:1,bulletMaxHeight:500,bulletsVariance:20,bulletsMaxdY:200,waveEasyCount:3,waveEasyTimeMin:4,waveEasyTimeMax:6,waveEasyAmplitudeMin:8,waveEasyAmplitudeMax:32,waveEasyFrequencyMin:.1,waveEasyFrequencyMax:.25,waveEasyRxMin:32,waveEasyRxMax:80,waveEasyRyMin:16,waveEasyRyMax:48,waveEasySyMin:16,waveEasySyMax:160,waveMediumCount:3,waveMediumTimeMin:4,waveMediumTimeMax:6,waveMediumAmplitudeMin:8,waveMediumAmplitudeMax:32,waveMediumFrequencyMin:.1,waveMediumFrequencyMax:.25,waveMediumRxMin:32,waveMediumRxMax:80,waveMediumRyMin:16,waveMediumRyMax:48,waveMediumSyMin:16,waveMediumSyMax:160,waveHardCount:3,waveHardTimeMin:4,waveHardTimeMax:6,waveHardAmplitudeMin:8,waveHardAmplitudeMax:32,waveHardFrequencyMin:.1,waveHardFrequencyMax:.25,waveHardRxMin:32,waveHardRxMax:80,waveHardRyMin:16,waveHardRyMax:48,waveHardSyMin:0,waveHardSyMax:160,powerUpMaxCount:5,backgroundSpeed:100,borderSpeed:50,borderPeakRandMin:1,borderPeakRandMax:3,borderFlatRandMin:8,borderFlatRandMax:24,engineTimeResolution:1,epsilon:.1,delta:.001};let w=m.width/m.worldWidth,b=m.height/m.worldHeight;function g(e,n){const i=new Image(t(f).meta.size.w,t(f).meta.size.h);return i.src=e,n&&(i.onload=n),i}function S(e,t,n){const i=c(e);i.width=t,i.height=n;const r=i.getContext("2d");return r.imageSmoothingEnabled=!1,r}function v(e,n){!function({gameCanvas:e,image:n},{x:i,y:r,ox:a,oy:s,sprite:l}){if(!n.complete)return;const d=t(f).frames[l].frame;e.drawImage(n,d.x,d.y,d.w,d.h,o((i-a)*w),o((r-s)*b),d.w*w,d.h*b)}(e,n),m.debug&&function({currentCanvas:e},{x:t,y:n,w:i,h:r,color:a}){e&&(e.fillStyle=a??"rgba(255, 165, 0, 0.5)"),e.fillRect(t*w,n*b,i*w,r*b)}(e,n)}function M({offscreenCanvas:e,currentCanvas:n,image:i},r,{x:a,y:o,w:s,h:l},d){if(!i.complete)return;const u=t(f).frames[r].frame;T(e),e.save();let h=e.canvas.height;d&&(e.scale(1,-1),h=u.h-h),e.drawImage(i,u.x,u.y,u.w,u.h,0,0,e.canvas.width,h),e.restore();const p=n.createPattern(e.canvas,"repeat");n.fillStyle=p,n.save(),n.translate(a*w,o*b),n.fillRect(0,0,s*w,l*b),n.restore()}function H(e,t){e.currentCanvas=t}function T(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}let C=0;let R,P=0;function z(e,t){const n=[];for(let i=0;i<t;i++)n.push(e());return n}function E(e,t){return{x:e,y:t}}function B(e,t){return E(e.x+t.x,e.y+t.y)}function W(e=m.bulletHeight,t=m.bulletWidth,n=!1,i){return{x:0,y:0,w:t,h:e,dx:0,dy:0,isActive:!1,dh:0,dhDirection:0,explodeTick:0,shielded:n,sprite:i?"assets/friendly_bullet.png":"assets/enemie_bullet.png",ox:m.bulletOx,oy:m.bulletOy}}function A(e){if(!e.isActive)return;e.x+=e.dx*m.delta;const t=e.h;if(e.h=d(e.h+e.dh,m.bulletMaxHeight),e.h==m.bulletMaxHeight&&(e.dy=-30*h(e.x/m.worldWidth*6*y)),e.y+=e.dy*m.delta-(e.h-t)*e.dhDirection,0!=e.explodeTick&&(e.explodeTick-=1,0==e.explodeTick)){if(null==e.bullets)return void O(e);const t=e.dx/2;for(let n=0;n<4;n++){let i=e.bullets.bullets.find((e=>!e.isActive));if(null==i)return void O(e);_(e.bullets,i,e,E(p(-1,n)*t,p(-1,s(n/2))*t+e.dy))}O(e)}(e.x<0||e.x>m.worldWidth)&&O(e),e.h==m.bulletHeight&&(e.y+e.h/2<0||e.y>m.worldHeight+e.h/2)&&O(e)}function k(e,t){if(t.isActive&&(v(e,t),t.bullets&&0==t.explodeTick&&t.bullets.bh!=t.h)){M(e,"assets/friendly_bullet.png"==t.sprite?"assets/friendly_vertical_laser.png":"assets/vertical_laser.png",t,!1)}}function _(e,t,n,i){t.x=n.x,t.y=n.y,t.dx=i.x,t.dy=i.y,t.isActive=!0,t.bullets=e}function O(e){e.isActive=!1,e.dx=0,e.dy=0,e.x=0,e.y=0,null!=e.bullets&&(e.h=e.bullets.bh,e.w=e.bullets.bw,e.shielded=e.bullets.shielded),e.dh=0}function F(...e){return e[Math.floor(Math.random()*e.length)]}function U(e,t){return Math.random()*(t-e)+e}function q(e,t){return e=Math.ceil(e),t=Math.floor(t)+1,Math.floor(Math.random()*(t-e)+e)}function D(){return`rgba(${q(0,255)}, ${q(0,255)}, ${q(0,255)}, 0.5)`}var I;function Y(e,t,n,i,r,a,o=!1,s){return{bullets:z((()=>W(r,a,o,s)),e),baseSpeedX:t,baseSpeedY:n,lastRandY:0,sprayOpen:i,shielded:o,bh:r,bw:a}}function L(e,t){let n=U(-t,t),i=e.lastRandY+n;var r,a;return r=d(m.bulletsMaxdY,i),a=-m.bulletsMaxdY,i=Math.max(r,a),e.lastRandY=i,i}function X(e,t,n,i,r=0){let a=L(e,r);if(i<R.ConicEnd)for(let o=0;o<=i;o++){let s=e.bullets.find((e=>!e.isActive));if(null==s)return;_(e,s,n,E(t,e.baseSpeedY*u(y*((o+1)/(i+2)))*e.sprayOpen+a)),a=L(e,r)}if(i==R.Straight){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;i.dh=t/m.playerBulletSpeedX*.2,i.dhDirection=.5,_(e,i,n,E(t,a))}if(i==R.StraightHole){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;if(i.dh=.4,i.dhDirection=0,_(e,i,n,E(t,a+150*i.dh+10)),i=e.bullets.find((e=>!e.isActive)),null==i)return;i.dh=.4,i.dhDirection=1,_(e,i,n,E(t,a-(150*i.dh+10)))}if(i==R.Explosion){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;i.w=m.bossBigBulletWidth,i.h=m.bossBigBulletHeight,i.bullets=e,i.explodeTick=m.bossBigBulletExplosionTick,_(e,i,B(n,E(m.bossBigBulletWidth,-m.bossBigBulletHeight/2)),E(t,a))}if(i==R.UpAndDown){for(let o=0;o<=10;o++){let s=e.bullets.find((e=>!e.isActive));if(null==s)return;_(e,s,B(n,E(m.bossWidth/2,m.bossHeight/2)),E(t*u(y*((o+1)/(i+2)))*.5+a,e.baseSpeedY)),a=L(e,r)}for(let o=0;o<=10;o++){let s=e.bullets.find((e=>!e.isActive));if(null==s)return;_(e,s,B(n,E(m.bossWidth/2,-m.bossHeight/2)),E(t*u(y*((o+1)/(i+2)))*.5+a,-e.baseSpeedY)),a=L(e,r)}}}function G(e){for(let t of N(e))A(t)}function Q(e,t){for(let n of N(t))k(e,n)}function N(e){return e.bullets.filter((e=>e.isActive))}function $(e){for(let t of e.bullets)O(t)}(I=R||(R={}))[I.Single=0]="Single",I[I.Double=1]="Double",I[I.Triple=2]="Triple",I[I.Quadruple=3]="Quadruple",I[I.Quintuple=4]="Quintuple",I[I.Sixtuple=5]="Sixtuple",I[I.ConicEnd=6]="ConicEnd",I[I.Straight=7]="Straight",I[I.StraightHole=8]="StraightHole",I[I.Explosion=9]="Explosion",I[I.UpAndDown=10]="UpAndDown";const j={waitTime:2,tx:.8*m.worldWidth-m.bossWidth,ty:.5*m.worldHeight-m.bossHeight/2,dx:5,dy:15,shootPattern:[R.Sixtuple,R.Quintuple,R.Triple,R.UpAndDown],shootCount:[4,3,5,5],shootFrequency:[4,3,2,5],shootSpeed:[200,120,250,50],shootRandom:[150,300,300,150],repeat:3,resetPosOnRepeat:!0},J={waitTime:3,tx:m.worldWidth-m.bossWidth,ty:.2*m.worldHeight,dx:0,dy:60,shootPattern:[R.UpAndDown,R.StraightHole],shootCount:[5,40],shootFrequency:[5,3],shootSpeed:[200,100],repeat:1,shootRandom:[0,20],resetPosOnRepeat:!0},V={waitTime:0,tx:m.worldWidth-m.bossWidth,ty:.5*m.worldHeight-m.bossHeight,dx:-50,dy:0,shootPattern:[R.Explosion,R.Double],shootCount:[10,5],shootFrequency:[3,5],shootSpeed:[500,600],repeat:2,shootRandom:[600,100],resetPosOnRepeat:!0};function K(){const e=D();return{x:.5*m.worldWidth-m.bossWidth/2,y:.5*m.worldHeight-m.bossHeight/2,w:m.bossWidth,h:m.bossHeight,dx:0,dy:0,color:e,bullets:Y(m.bossBulletsPoolSize,m.bossBulletSpeedX,m.bossBulletSpeedY,m.bossSprayOpen,m.bulletWidth,m.bulletHeight,void 0,!1),elapsedTime:0,currentPattern:J,shootElapsedTime:0,newPatternTime:0,shootCount:0,targetReached:!1,patternIndex:0,repeatCount:0,life:m.bossLife,sprite:"assets/boss.png",ox:m.bossOx,oy:m.bossOy}}function Z(e){G(e.bullets),e.elapsedTime+=m.delta,e.shootElapsedTime+=m.delta;const t=m.bossSpeed;if(0!=e.newPatternTime){if(!(e.elapsedTime>=e.newPatternTime))return;e.newPatternTime=0,e.currentPattern==j?e.currentPattern=J:e.currentPattern==J?e.currentPattern=V:e.currentPattern==V&&(e.currentPattern=j)}if(e.targetReached?(e.y>.9*m.worldHeight-m.bossHeight||e.y<.1*m.worldHeight)&&(e.dy*=-1):(e.x>e.currentPattern.tx?e.dx=-t:e.x<e.currentPattern.tx&&(e.dx=t),e.y>e.currentPattern.ty?e.dy=-t:e.y<e.currentPattern.ty&&(e.dy=t)),e.x+=e.dx*m.delta,e.y+=e.dy*m.delta,e.targetReached)if(e.sprite="assets/boss2.png",e.shootCount<e.currentPattern.shootCount[e.patternIndex])e.shootElapsedTime>=1/e.currentPattern.shootFrequency[e.patternIndex]&&(e.shootCount+=1,e.shootElapsedTime=0,null!=e.currentPattern.shootPattern[e.patternIndex]&&X(e.bullets,e.dx-e.currentPattern.shootSpeed[e.patternIndex],B(e,E(0,m.bossHeight/2)),e.currentPattern.shootPattern[e.patternIndex],e.currentPattern.shootRandom[e.patternIndex]));else if(e.sprite="assets/boss.png",e.shootCount=0,e.bullets.lastRandY=0,e.patternIndex+1==e.currentPattern.shootFrequency.length){if(e.patternIndex=0,e.repeatCount+1==e.currentPattern.repeat)return e.repeatCount=0,e.targetReached=!1,void(e.newPatternTime=e.elapsedTime+e.currentPattern.waitTime);e.repeatCount+=1,e.currentPattern.resetPosOnRepeat&&(e.targetReached=!1)}else e.patternIndex+=1;else if(l(e.currentPattern.tx-e.x)<1&&l(e.currentPattern.ty-e.y)<1)return e.targetReached=!0,e.dx=e.currentPattern.dx,void(e.dy=e.currentPattern.dy)}function ee(e,t){Q(e,t.bullets),v(e,t)}function te(e){e.x=.5*m.worldWidth-m.bossWidth/2,e.y=.5*m.worldHeight-m.bossHeight/2,e.dx=0,e.dy=0,$(e.bullets),e.elapsedTime=0,e.currentPattern=J,e.shootElapsedTime=0,e.newPatternTime=0,e.shootCount=0,e.targetReached=!1,e.patternIndex=0,e.repeatCount=0}let ne;var ie;let re;function ae(e,t,n,i,r,a,o,s,l=R.Single,d){return{x:m.worldWidth,y:e,sy:e,dx:0,dy:0,w:m.enemyWidth,h:m.enemyHeight,pattern:t,time:i,color:n,dead:!1,amplitude:r,frequency:a,rx:o,ry:s,elapsedTime:0,shootElapsedTime:0,distance:0,direction:ne.Left,bullets:Y(m.enemyBulletsPoolSize,m.enemyBulletSpeedX,m.enemyBulletSpeedY,m.enemySprayOpen,m.bulletWidth,m.bulletHeight,void 0,!1),bulletsPattern:l,sprite:d,ox:m.enemyOx,oy:m.enemyOy}}function oe(e){if(G(e.bullets),e.dead)return;const t=e.frequency,n=e.amplitude,i=(m.worldWidth+m.enemyWidth)/e.time;e.elapsedTime+=m.delta,e.shootElapsedTime+=m.delta,e.pattern==re.Circular&&(e.dx=2*y*t*n*u(2*y*t*e.elapsedTime)-i,e.dy=2*y*t*n*h(2*y*t*e.elapsedTime)),e.pattern==re.Rectangular&&(null==e.direction&&(e.direction=ne.Left),e.direction==ne.Left&&(e.distance>=e.rx&&(e.y+e.ry>m.worldHeight-1.5*m.tileSize?e.direction=ne.Up:e.y-e.ry<.5*m.tileSize?e.direction=ne.Down:e.direction=F(ne.Up,ne.Down),e.distance=0),e.dx=-i,e.dy=0,e.distance+=-e.dx*m.delta),e.direction,ne.Right,e.direction==ne.Up&&(e.distance>=e.ry&&(e.direction=ne.Left,e.distance=0),e.dy=-i/2,e.dx=0,e.distance+=-e.dy*m.delta),e.direction==ne.Down&&(e.distance>=e.ry&&(e.direction=ne.Left,e.distance=0),e.dy=i/2,e.dx=0,e.distance+=e.dy*m.delta)),e.pattern==re.Triangular&&(e.y>=e.sy+n&&(e.dy=-4*n*t),(0==e.dy||e.y<=e.sy-n)&&(e.dy=4*n*t),e.dx=-i),e.pattern==re.Straight&&(e.dx=-i),e.x+=e.dx*m.delta,e.y+=e.dy*m.delta,e.shootElapsedTime>=1/m.enemyShootFrequency&&(e.shootElapsedTime=0,X(e.bullets,-i-m.enemyBulletSpeedX,B(e,E(0,m.enemyHeight/2)),e.bulletsPattern))}function se(e,t){Q(e,t.bullets),t.dead||v(e,t)}(ie=ne||(ne={}))[ie.Up=0]="Up",ie[ie.Left=1]="Left",ie[ie.Right=2]="Right",ie[ie.Down=3]="Down",function(e){e[e.Straight=0]="Straight",e[e.Triangular=1]="Triangular",e[e.Circular=2]="Circular",e[e.Rectangular=3]="Rectangular"}(re||(re={}));const le={up:!1,down:!1,left:!1,right:!1,space:!1,shift:!1,m:!1};function de(e){let t=!0;return()=>le[e]&&t?(t=!1,!0):(le[e]||(t=!0),!1)}onkeydown=onkeyup=e=>function(e,t){38!=e&&90!=e&&87!=e||(le.up=t);39!=e&&68!=e||(le.right=t);40!=e&&83!=e||(le.down=t);37!=e&&65!=e&&81!=e||(le.left=t);16==e&&(le.shift=t);32==e&&(le.space=t);77==e&&(le.m=t)}(e.keyCode,null!=e.type[5]);let ue,he,pe,ce,ye,fe=null,xe=(...e)=>{let t=fe.createBufferSource(),n=fe.createBuffer(e.length,e[0].length,be);return e.map(((e,t)=>n.getChannelData(t).set(e))),t.buffer=n,t.connect(fe.destination),t.start(),t},me=(e=1,t=.05,n=220,i=0,r=0,a=.1,o=0,s=1,l=0,d=0,u=0,h=0,p=0,c=0,y=0,f=0,x=0,m=1,w=0,b=0)=>{let g,S,v=2*Math.PI,M=l*=500*v/be**2,H=(0<y?1:-1)*v/4,T=n*=(1+2*t*Math.random()-t)*v/be,C=[],R=0,P=0,z=0,E=1,B=0,W=0,A=0;for(d*=500*v/be**3,y*=v/be,u*=v/be,h*=be,p=be*p|0,S=(i=99+be*i)+(w*=be)+(r*=be)+(a*=be)+(x*=be)|0;z<S;C[z++]=A)++W%(100*f|0)||(A=o?1<o?2<o?3<o?Math.sin((R%v)**3):Math.max(Math.min(Math.tan(R),1),-1):1-(2*R/v%2+2)%2:1-4*Math.abs(Math.round(R/v)-R/v):Math.sin(R),A=(p?1-b+b*Math.sin(2*Math.PI*z/p):1)*(0<A?1:-1)*Math.abs(A)**s*e*we*(z<i?z/i:z<i+w?1-(z-i)/w*(1-m):z<i+w+r?m:z<S-x?(S-z-x)/a*m:0),A=x?A/2+(x>z?0:(z<S-x?1:(S-z)/x)*C[z-x|0]/2):A),g=(n+=l+=d)*Math.sin(P*y-H),R+=g-g*c*(1-1e9*(Math.sin(z)+1)%2),P+=g-g*c*(1-1e9*(Math.sin(z)**2+1)%2),E&&++E>h&&(n+=u,T+=u,E=0),!p||++B%p||(n=T,l=M,E=E||1);return C},we=.3,be=44100,ge=(e,t,n,i=125)=>{let r,a,o,s,l,d,u,h,p,c,y,f,x,m,w,b=0,g=[],S=[],v=[],M=0,H=0,T=1,C={},R=be/i*60>>2;for(;T;M++)g=[T=h=y=x=0],n.map(((i,y)=>{for(u=t[i][M]||[0,0,0],T|=!!t[i][M],w=x+(t[i][0].length-2-!h)*R,m=y==n.length-1,a=2,s=x;a<u.length+m;h=++a){for(l=u[a],p=a==u.length+m-1&&m||c!=(u[0]||0)|l|0,o=0;o<R&&h;o++>R-99&&p&&(f+=(f<1)/99))d=(1-f)*g[b++]/2||0,S[s]=(S[s]||0)-d*H+d,v[s]=(v[s++]||0)+d*H+d;l&&(f=l%1,H=u[1]||0,(l|=0)&&(g=C[[c=u[b=0]||0,l]]=C[[c,l]]||(r=[...e[c]],r[2]*=2**((l-12)/12),l>0?me(...r):[])))}x=w}));return[S,v]},Se=[[[,0,261,,,2,2,,,,,,,,,,.01],[,0,32,.05,,.2,3,5],[3,0,43,,,.25,,,,,,,,2],[1.6,0,655,,,,3,1.65,,,,,.02,3.8,-.1,,.2],[,0,232,.01,.09,.15,2,,,,,,154.87,,,,.26]],[[[,,4,,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,4,,,,,,3,,,,,,,,,,,,,,,,,,,,,,3,,,,],[,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,,,,,,,,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[2,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[4,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,,,,,,,,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,22,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[2,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[4,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,,,,,,,,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,22,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[4,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,,,,,,,,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,15,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,13]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[4,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,,,,,,,,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,22,,,,,,,,],[4,,13,13,13,13,13,13,12,12,12,12,12,12,12,,,,12,12,12,12,,,,,12,12,12,12,12,12,12,12,13,13,13,13,13,13,10,10,10,10,10,10,,,,,10,10,10,10,,,,,,10,10,10,10,10,10,10],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[4,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,,,,,,,,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,15,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,13]]],[0,1,1,2,2,3,3,4,4,5,5,3,3,4,4,5,5,2,2],135,undefined],ve=[[[.5,0,128,,.08,.5,3],[.8,0,32,,.07,.11,2,0,,,.5,.01],[2,0,4e3,,,.03,2,1.25,,,,,.02,6.8,-.3,,.5],[.9,0,32,,,.35,3,2]],[[[1,,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,15,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,21],[,,15,,20,15,,18,,,,,,,21,16,15,,15,,20,15,,20,,,,,,,23,18,15,,],[2,,,,,,,,,,13,13,13,13,,,,,,,,,,,,,1,1,1,1,,,,,]],[[1,,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,15,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,21],[,,15,,20,15,,18,,,,,,,21,16,15,,15,,20,15,,20,,,,,,,23,18,15,,],[2,,,,,,,,,,13,13,13,13,,,,,,,,,,,,,1,1,1,1,,,,,],[3,,20,,,,20,,,,20,,,,20,,15,,13,,,,13,,,,13,,,,13,,16,,]],[[1,,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,15,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,21]]],[2,2,0,0,1,0,1,0,1,0],80],Me=[[[1.5,0,130,,,.5,,,,,,,,,,,,.15,.6],[,0,130,.01,.09,.15,2,,,,,,154.87,,,,.26],[1.4,0,32,,,.25,3,5]],[[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[1,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,10,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,13,,],[,,36,32,34,,,,,,29,25,27,,,,,,22,,,,22,,,,,,,,,,,,22,25,24,,,,,,29,32,30,,,,,,25,,,,25,,,,25,,,,25,,,,],[2,,12,,12,,12,,12,,12,,12,,12,,12,,10,,10,,10,,10,,10,,10,,10,,10,,12,,12,,12,,12,,12,,12,,12,,12,,10,,10,,10,,10,,10,,10,,10,,5,,]],[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[1,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,10,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,13,,],[,,36,32,34,,,,,,29,25,27,,,,,,22,,,,22,,,,,,,,,,,,22,25,24,,,,,,29,32,30,,,,,,25,,,,25,,,,25,,,,25,,,,]],[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[,,36,32,34,,,,,,29,25,27,,,,,,22,,,,22,,,,,,,,,,,,22,25,24,,,,,,29,32,30,,,,,,25,,,,25,,,,25,,,,25,,,,]],[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[1,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,10,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,13,,]]],[2,3,3,1,1,0,0,0,0,0,0],120],He=[[[1.5,0,32,.05,.25,,3,3,,,,,,,,,3,.6],[,0,128,,,.2,2,,,,,,,,,.02,.01],[,0,1024,,,.3,2,.2,-.1,-.15,9,.02,,.1,.12,,.06]],[[[,,13,,13,,,,,,6,,6,,,,,,8,,8,,,,,,3,,3,,,,,,],[1,,25,,25,,25,,25,,18,,18,,18,,18,,12,,12,,12,,12,,3,,3,,3,,3,,],[1,,22,,22,,22,,22,,15,,15,,15,,15,,8,,8,,8,,8,,6,,6,,6,,6,,],[2,,25,22,,,,,,,15,18,,15,,,,,12,,,,,,,,6,,6,6,,3,,,]],[[,,13,,13,,,,,,6,,6,,,,,,8,,8,,,,,,3,,3,,,,,,],[1,,25,,25,,25,,25,,18,,18,,18,,18,,12,,12,,12,,12,,3,,3,,3,,3,,],[1,,22,,22,,22,,22,,15,,15,,15,,15,,8,,8,,8,,8,,6,,6,,6,,6,,],[2,,25,22,,,,,,,15,15,,18,,,,,8,8,,12,,,,,6,,6,6,,3,,,]],[[,,13,,13,,,,,,6,,6,,,,,,8,,8,,,,,,3,,3,,,,,,],[1,,25,,,,,,,,18,,,,18,,,,12,,,,,,,,3,,,,3,,,,],[1,,22,,,,22,,,,15,,,,,,,,8,,,,8,,,,6,,,,,,,,]]],[2,2,0,1,0,1],120];var Te;(Te=ye||(ye={}))[Te.Speed=0]="Speed",Te[Te.Shield=1]="Shield",Te[Te.Multishot=2]="Multishot";let Ce=0,Re=0,Pe=0,ze=0,Ee=null,Be=0,We=!0;function Ae(e){c("ui-shop").style.display=e?"flex":"none"}function ke(e){c("current-money").innerText=e.toString()}function _e(e){Pe=e,Oe()}function Oe(){c("current-speed").innerText=Ce.toString(),c("current-shield").innerText=Re.toString(),c("current-multishot").innerText=ze.toString(),c("current-player-shield").innerText=Pe.toString(),c("speed-plus").style.color=Ce==m.powerUpMaxCount?"gray":"black",c("shield-plus").style.color=Re==m.powerUpMaxCount?"gray":"black",c("multishot-plus").style.color=ze==m.powerUpMaxCount?"gray":"black",c("speed-minus").style.color=0==Ce?"gray":"black",c("shield-minus").style.color=0==Re?"gray":"black",c("multishot-minus").style.color=0==ze?"gray":"black",c("current-progress").style.width=`${Be}%`,c("shop").style.display=We?"none":"flex",c("shop-label").style.display=We?"none":"block"}window.onPowerUpChanged=function(e,t){const n=Ee.player;Qe(n,-t)&&(e==ye.Speed&&(Ce+=t),e==ye.Shield&&(Re+=t),e==ye.Multishot&&(ze+=t),Ce<0&&(Ce=0,Qe(n,t)),Ce>m.powerUpMaxCount&&(Ce=m.powerUpMaxCount,Qe(n,t)),Re<0&&(Re=0,Qe(n,t)),Re>m.powerUpMaxCount&&(Re=m.powerUpMaxCount,Qe(n,t)),ze<0&&(ze=0,Qe(n,t)),ze>m.powerUpMaxCount&&(ze=m.powerUpMaxCount,Qe(n,t)),Oe())},window.play=function(){ct(Ve.Game,Ee),We=!1};const Fe=de("space"),Ue=de("shift");let qe,De=!1,Ie=!1,Ye=["assets/cerbere.png","assets/cerbere2.png"];function Le(e){let t=0,n=0;G(e.bullets),e.invincibleTime>0?e.invincibleTime-=m.delta:e.invincibleTime=0,le.left&&(t+=-m.playerSpeedX),le.right&&(t+=m.playerSpeedX),le.up&&(n+=-m.playerSpeedY),le.down&&(n+=m.playerSpeedY),Fe()&&function(e){null!=e.bullets.bullets.find((e=>!e.isActive))&&X(e.bullets,(.5*e.shootSpeed+1)*m.playerBulletSpeedX,B(e,E(m.playerWidth,m.playerHeight/2)),e.bulletsPattern)}(e),e.dx=t,e.dy=n,Ie||(fe=new window.AudioContext,he=ge(...Me),ue=[ge(...Se),ge(...ve)],pe=ge(...He),Ie=!0),Ie&&Ue()&&(De?ce.stop():(fe?.resume(),ce=xe(...ue[q(0,1)]),ce.loop=!0),De=!De),e.x+=e.dx*m.delta,e.y+=e.dy*m.delta,e.x<=0&&(e.x=0),e.x>=m.worldWidth-m.playerWidth&&(e.x=m.worldWidth-m.playerWidth),e.y<=0&&(e.y=0),e.y>=m.worldHeight-m.playerHeight&&(e.y=m.worldHeight-m.playerHeight),e.animationTime+=m.delta,e.animationTime>m.playerAnimationTime&&(e.animationTime=0,e.sprite=e.sprite==Ye[0]?Ye[1]:Ye[0])}function Xe(e){e.x=m.playerWidth,e.y=m.worldHeight/2,e.dx=0,e.dy=0;let t=[Ce,Re,ze];e.shootSpeed=t[ye.Speed],e.shieldCount=t[ye.Shield],e.shieldCount==m.powerUpMaxCount&&(e.bullets.shielded=!0),t[ye.Multishot]==m.powerUpMaxCount?e.bulletsPattern=R.Straight:e.bulletsPattern=t[ye.Multishot],_e(e.shieldCount)}function Ge(e){return 0==e.invincibleTime&&(e.shieldCount-=1,e.shieldCount<0&&(e.shieldCount=0),e.invincibleTime=m.playerInvincibleTime),_e(e.shieldCount),e.shieldCount}function Qe(e,t){return!(e.money+t<0)&&(e.money+=t,ke(e.money),!0)}var Ne;(Ne=qe||(qe={}))[Ne.Easy=0]="Easy",Ne[Ne.Medium=1]="Medium",Ne[Ne.Hard=2]="Hard";let $e=["assets/floating_eye.png","assets/imp.png","assets/skeleton.png","assets/zombie.png"];function je(e){const t=[];if(e==qe.Easy){const n=q(3,6);for(let i=0;i<n;i++)t.push(Je(e))}if(e==qe.Medium){const n=q(5,10);for(let i=0;i<n;i++)t.push(Je(e))}if(e==qe.Hard){const n=q(9,17);for(let i=0;i<n;i++)t.push(Je(e))}return{difficulty:e,enemies:t}}function Je(e){const t=D();if(e==qe.Easy){const e=F(re.Straight,re.Triangular),n=U(m.waveEasyAmplitudeMin,m.waveEasyAmplitudeMax),i=U(m.waveEasyFrequencyMin,m.waveEasyFrequencyMax),r=U(m.waveEasyRxMin,m.waveEasyRxMax),a=U(m.waveEasyRyMin,m.waveEasyRyMax);return ae(U(m.waveEasySyMin,m.waveEasySyMax),e,t,U(m.waveEasyTimeMin,m.waveEasyTimeMax),n,i,r,a,q(R.Single,R.Double),F(...$e))}if(e==qe.Medium){const e=F(re.Straight,re.Triangular,re.Rectangular),n=U(m.waveMediumAmplitudeMin,m.waveMediumAmplitudeMax),i=U(m.waveMediumFrequencyMin,m.waveMediumFrequencyMax),r=U(m.waveMediumRxMin,m.waveMediumRxMax),a=U(m.waveMediumRyMin,m.waveMediumRyMax);return ae(U(m.waveMediumSyMin,m.waveMediumSyMax),e,t,U(m.waveMediumTimeMin,m.waveMediumTimeMax),n,i,r,a,q(R.Single,R.Quintuple),F(...$e))}if(e==qe.Hard){const e=F(re.Triangular,re.Rectangular,re.Circular),n=U(m.waveHardAmplitudeMin,m.waveHardAmplitudeMax),i=U(m.waveHardFrequencyMin,m.waveHardFrequencyMax),r=U(m.waveHardRxMin,m.waveHardRxMax),a=U(m.waveHardRyMin,m.waveHardRyMax);return ae(U(m.waveHardSyMin,m.waveHardSyMax),e,t,U(m.waveHardTimeMin,m.waveHardTimeMax),n,i,r,a,q(R.Double,R.Sixtuple),F(...$e))}throw new Error}let Ve,Ke=1,Ze=m.waveEasyCount+m.waveMediumCount+m.waveHardCount+1,et=de("m");function tt(e){if((e.entities.every((e=>e.x<-e.w))||e.deadCount==e.entities.length)&&rt(e),Ke<Ze)for(let t of e.entities)oe(t);else Z(e.boss);et()&&rt(e)}function nt(e,t){if(Ke<Ze)for(let n of t.entities)se(e,n);else ee(e,t.boss)}function it(e){return e.entities.filter((e=>!e.dead))}function rt(e){Ke++;let t=qe.Easy;var n;Ke>3&&Ke<=6&&(t=qe.Medium),Ke>6&&(t=qe.Hard),e.entities=je(t).enemies,e.deadCount=0,Qe(e.player,1),n=Ke/9*50+(m.bossLife-e.boss.life)/m.bossLife*50,Be=n,Oe()}function at(e,t){e.dead=!0,t.deadCount++}function ot(e,t){const n=dt(st(e),st(t)),i=dt(lt(e),lt(t));return null==n||null==i?null:{x:n.x,y:i.x,w:n.y-n.x,h:i.y-i.x}}function st(e){return{x:e.x,y:e.x+e.w}}function lt(e){return{x:e.y,y:e.y+e.h}}function dt(e,t){return e.y<=t.x||t.y<=e.x?null:{x:Math.max(e.x,t.x),y:Math.min(e.y,t.y)}}var ut;function ht(e){e.scene==Ve.Game&&(C-=m.backgroundSpeed*m.delta,C<=-3*m.worldWidth&&(C=0),P-=m.borderSpeed*m.delta,P<=-3*m.worldWidth&&(P=0),Le(e.player),tt(e.enemies),function(e){const t=e.enemies,n=e.player;for(let i of it(t)){for(let e of N(n.bullets))if(null!=ot(i,e)){O(e),at(i,t);break}for(let t of N(i.bullets))if(null!=ot(n,t)){0==Ge(n)&&ct(Ve.Shop,e);break}null!=ot(n,i)&&ct(Ve.Shop,e)}for(let i of N(t.boss.bullets))null!=ot(n,i)&&0==Ge(n)&&ct(Ve.Shop,e);for(let e of N(n.bullets))null!=ot(t.boss,e)&&(O(e),t.boss.life--)}(e))}function pt(e,t){H(e,e.backgroundCanvas),function(e,t){M(e,t.sprite,{x:C,y:0,w:4*m.worldWidth,h:m.worldHeight},!1)}(e,t.background),t.scene==Ve.Game&&(H(e,e.gameCanvas),function(e,t){s(t.invincibleTime/m.playerBlinkPeriod)%2==0&&v(e,t);for(let n of t.bullets.bullets)n.isActive&&k(e,n);0!=t.shieldCount&&v(e,{...t,sprite:"assets/shield.png",x:t.x-4,y:t.y-4})}(e,t.player),nt(e,t.enemies)),H(e,e.foregroundCanvas),function(e){M(e,"assets/border1.png",{x:P,y:m.worldHeight-m.tileSize,w:4*m.worldWidth,h:m.tileSize},!1),M(e,"assets/border1.png",{x:P,y:0,w:4*m.worldWidth,h:m.tileSize},!0)}(e)}function ct(e,t){var n;Xe(t.player),n=t.enemies,Ke=1,rt(n),te(t.enemies.boss),t.scene=e,e==Ve.Shop&&Ae(!0),e==Ve.Game&&Ae(!1)}(ut=Ve||(Ve={}))[ut.Shop=0]="Shop",ut[ut.Game=1]="Game",ut[ut.Quest=2]="Quest";let yt=m.engineTimeResolution,ft=performance.now(),xt=ft;const mt=function(){const e=S("game-canvas",m.width,m.height);return{image:g(x),gameCanvas:e,backgroundCanvas:S("background-canvas",m.width,m.height),foregroundCanvas:S("foreground-canvas",m.width,m.height),offscreenCanvas:S("offscreen-canvas",m.tileSize*w,m.tileSize*b),currentCanvas:e}}(),wt=function(){const e=function(){const e={x:m.playerWidth,dx:0,y:m.worldHeight/2,dy:0,w:m.playerWidth,h:m.playerHeight,bullets:Y(m.playerBulletsPoolSize,m.playerBulletSpeedX,m.playerBulletSpeedY,m.playerSprayOpen,m.playerBulletWidth,m.playerBulletHeight,void 0,!0),bulletsPattern:R.Single,shootSpeed:1,shieldCount:0,money:10,sprite:Ye[0],invincibleTime:0,ox:m.playerOx,oy:m.playerOy,animationTime:0};return ke(e.money),e}(),t=function(e){return{entities:je(qe.Easy).enemies,deadCount:0,boss:K(),player:e}}(e),n={background:{x:0,y:0,w:0,h:0,sprite:"assets/basic_cobble.png",ox:0,oy:0},player:e,enemies:t,scene:Ve.Shop};return Ee=n,Oe(),n}();!function e(t){window.requestAnimationFrame((t=>e(t)));var n=0;t>ft+yt&&(n=s((t-ft)/yt));for(var i=0;i<n;i++)ft+=yt,ht(wt);(function({gameCanvas:e,backgroundCanvas:t,offscreenCanvas:n,foregroundCanvas:i}){T(e),T(t),T(i),T(n)})(mt),pt(mt,wt),xt=t}(0);