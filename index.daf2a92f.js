function e(e){return Math.round(e)}function n(e){return Math.floor(e)}function d(e){return Math.ceil(e)}function i(e,n){return Math.min(e,n)}function u(e){return Math.cos(e)}function t(e){return Math.sin(e)}function f(e,n){return Math.pow(e,n)}function a(e){return document.getElementById(e)}const r=Math.PI,l={debug:!1,width:960,height:640,playerSpeedX:300,playerSpeedY:300,playerWidth:50,playerHeight:50,playerBulletSpeedX:800,playerBulletSpeedY:100,playerBulletsPoolSize:200,playerSprayOpen:3,enemyWidth:50,enemyHeight:50,enemyBulletSpeedX:150,enemyBulletSpeedY:50,enemyBulletsPoolSize:50,enemyShootFrequency:1,enemyBulletPoolSize:1e3,enemySprayOpen:1,bossWidth:150,bossHeight:150,bossRxMin:100,bossRxMax:200,bossRyMin:100,bossRyMax:200,bossSpeed:300,bossBulletSpeedX:100,bossBulletSpeedY:100,bossBulletsPoolSize:200,bossBigBulletWidth:25,bossBigBulletHeight:25,bossBigBulletExplosionTick:200,bossPatternFrequency:5,bossSprayOpen:2,bulletWidth:5,bulletHeight:5,bulletMaxHeight:500,bulletsVariance:20,bulletsMaxdY:200,waveEasyCount:3,waveEasyTimeMin:4,waveEasyTimeMax:6,waveEasyAmplitudeMin:10,waveEasyAmplitudeMax:50,waveEasyFrequencyMin:.1,waveEasyFrequencyMax:.25,waveEasyRxMin:100,waveEasyRxMax:200,waveEasyRyMin:100,waveEasyRyMax:200,waveEasySyMin:0,waveEasySyMax:590,waveMediumCount:3,waveMediumTimeMin:4,waveMediumTimeMax:6,waveMediumAmplitudeMin:10,waveMediumAmplitudeMax:50,waveMediumFrequencyMin:.1,waveMediumFrequencyMax:.25,waveMediumRxMin:100,waveMediumRxMax:200,waveMediumRyMin:100,waveMediumRyMax:200,waveMediumSyMin:0,waveMediumSyMax:590,waveHardCount:3,waveHardTimeMin:4,waveHardTimeMax:6,waveHardAmplitudeMin:10,waveHardAmplitudeMax:50,waveHardFrequencyMin:.1,waveHardFrequencyMax:.25,waveHardRxMin:100,waveHardRxMax:200,waveHardRyMin:100,waveHardRyMax:200,waveHardSyMin:0,waveHardSyMax:590,engineTimeResolution:1,epsilon:.1,delta:.001};function o(e,n,d=null){const i=null==d?(u="canvas",document.createElement(u)):a(d);var u;i.width=e,i.height=n;return i.getContext("2d")}function s({canvas:n},{x:d,y:i,w:u,h:t},f="#FF0000"){n&&(n.fillStyle=f),n.fillRect(e(d),e(i),u,t)}function h(e,n){return{x:e,y:n}}function y(e,n){return h(e.x+n.x,e.y+n.y)}function c(e){if(!e.isActive)return;e.x+=e.dx*l.delta;const d=e.h;if(e.h=i(e.h+e.dh,l.bulletMaxHeight),e.h==l.bulletMaxHeight&&(e.dy=-30*t(e.x/l.width*6*r)),e.y+=e.dy*l.delta-(e.h-d)*e.dhDirection,0!=e.explodeTick&&(e.explodeTick-=1,0==e.explodeTick)){if(null==e.bullets)return void M(e);const d=e.dx/2;for(let i=0;i<4;i++){let u=e.bullets.bullets.find((e=>!e.isActive));if(null==u)return void M(e);x(u,e,h(f(-1,i)*d,f(-1,n(i/2))*d+e.dy))}M(e)}(e.x<0||e.x>l.width)&&M(e),e.h==l.bulletHeight&&(e.y<0||e.y>l.height)&&M(e)}function p(e,n){n.isActive&&s(e,n)}function x(e,n,d){e.x=n.x,e.y=n.y,e.dx=d.x,e.dy=d.y,e.isActive=!0}function M(e){e.isActive=!1,e.dx=0,e.dy=0,e.x=0,e.y=0,e.h=l.bulletHeight,e.w=l.bulletWidth,e.dh=0}function w(e,n){const d=[];for(let i=0;i<n;i++)d.push(e());return d}function m(...e){return e[Math.floor(Math.random()*e.length)]}function g(e,n){return Math.random()*(n-e)+e}function v(e,n){return e=Math.ceil(e),n=Math.floor(n)+1,Math.floor(Math.random()*(n-e)+e)}function b(){return Math.floor(16777215*Math.random()).toString(16)}let S;var H;function P(e,n,d,i){return{bullets:w((()=>({x:0,y:0,w:l.bulletWidth,h:l.bulletHeight,dx:0,dy:0,isActive:!1,dh:0,dhDirection:0,explodeTick:0,bullets:void 0})),e),baseSpeedX:n,baseSpeedY:d,lastRandY:0,sprayOpen:i}}function R(e,n){let d=g(-n,n),u=e.lastRandY+d;var t,f;return t=i(l.bulletsMaxdY,u),f=-l.bulletsMaxdY,u=Math.max(t,f),e.lastRandY=u,u}function T(e,n,d,i,t=0){let f=R(e,t);if(i<S.ConicEnd)for(let a=0;a<=i;a++){let l=e.bullets.find((e=>!e.isActive));if(null==l)return;x(l,d,h(n,e.baseSpeedY*u(r*((a+1)/(i+2)))*e.sprayOpen+f)),f=R(e,t)}if(i==S.Straight){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;i.dh=.1,x(i,d,h(n,f))}if(i==S.StraightHole){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;if(i.dh=.4,i.dhDirection=0,x(i,d,h(n,f+150*i.dh+10)),i=e.bullets.find((e=>!e.isActive)),null==i)return;i.dh=.4,i.dhDirection=1,x(i,d,h(n,f-(150*i.dh+10)))}if(i==S.Explosion){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;i.w=l.bossBigBulletWidth,i.h=l.bossBigBulletHeight,i.bullets=e,i.explodeTick=l.bossBigBulletExplosionTick,x(i,y(d,h(l.bossBigBulletWidth,-l.bossBigBulletHeight/2)),h(n,f))}if(i==S.UpAndDown){for(let a=0;a<=10;a++){let o=e.bullets.find((e=>!e.isActive));if(null==o)return;x(o,y(d,h(l.bossWidth/2,l.bossHeight/2)),h(n*u(r*((a+1)/(i+2)))*.5+f,e.baseSpeedY)),f=R(e,t)}for(let a=0;a<=10;a++){let o=e.bullets.find((e=>!e.isActive));if(null==o)return;x(o,y(d,h(l.bossWidth/2,-l.bossHeight/2)),h(n*u(r*((a+1)/(i+2)))*.5+f,-e.baseSpeedY)),f=R(e,t)}}}function E(e){for(let n of e.bullets)c(n)}function B(e,n){for(let d of n.bullets)p(e,d)}(H=S||(S={}))[H.Single=0]="Single",H[H.Double=1]="Double",H[H.Triple=2]="Triple",H[H.Quadruple=3]="Quadruple",H[H.Quintuple=4]="Quintuple",H[H.Sixtuple=5]="Sixtuple",H[H.ConicEnd=6]="ConicEnd",H[H.Straight=7]="Straight",H[H.StraightHole=8]="StraightHole",H[H.Explosion=9]="Explosion",H[H.UpAndDown=10]="UpAndDown";const A={waitTime:2,tx:.8*l.width-l.bossWidth,ty:.5*l.height-l.bossHeight/2,dx:5,dy:15,shootPattern:[S.Sixtuple,S.Quintuple,S.Triple,S.UpAndDown],shootCount:[4,3,5,5],shootFrequency:[4,3,2,5],shootSpeed:[200,120,250,50],shootRandom:[150,300,300,150],repeat:3,resetPosOnRepeat:!0},C={waitTime:3,tx:l.width-l.bossWidth,ty:.2*l.height,dx:0,dy:60,shootPattern:[S.UpAndDown,S.StraightHole],shootCount:[5,40],shootFrequency:[5,3],shootSpeed:[200,100],repeat:1,shootRandom:[0,20],resetPosOnRepeat:!0},W={waitTime:0,tx:l.width-l.bossWidth,ty:.5*l.height-l.bossHeight,dx:-50,dy:0,shootPattern:[S.Explosion,S.Double],shootCount:[10,5],shootFrequency:[3,5],shootSpeed:[500,600],repeat:2,shootRandom:[600,100],resetPosOnRepeat:!0};let F;var q;let Y,D;function I(e,n,d,i,u,t,f,a,r=S.Single){return{x:l.width,y:e,sy:e,dx:0,dy:0,w:l.enemyWidth,h:l.enemyHeight,pattern:n,time:i,color:d,dead:!1,amplitude:u,frequency:t,rx:f,ry:a,elapsedTime:0,shootElapsedTime:0,distance:0,direction:F.Left,bullets:P(l.enemyBulletsPoolSize,l.enemyBulletSpeedX,l.enemyBulletSpeedY,l.enemySprayOpen),bulletsPattern:r}}var O;function X(e){const n=[];if(e==D.Easy){const d=v(3,6);for(let i=0;i<d;i++)n.push(k(e))}if(e==D.Medium){const d=v(5,10);for(let i=0;i<d;i++)n.push(k(e))}if(e==D.Hard){const d=v(9,17);for(let i=0;i<d;i++)n.push(k(e))}return{difficulty:e,enemies:n}}function k(e){const n=`#${b()}`;if(e==D.Easy){const e=m(Y.Straight,Y.Triangular),d=g(l.waveEasyAmplitudeMin,l.waveEasyAmplitudeMax),i=g(l.waveEasyFrequencyMin,l.waveEasyFrequencyMax),u=g(l.waveEasyRxMin,l.waveEasyRxMax),t=g(l.waveEasyRyMin,l.waveEasyRyMax);return I(g(l.waveEasySyMin,l.waveEasySyMax),e,n,g(l.waveEasyTimeMin,l.waveEasyTimeMax),d,i,u,t,v(S.Single,S.Double))}if(e==D.Medium){const e=m(Y.Straight,Y.Triangular,Y.Rectangular),d=g(l.waveMediumAmplitudeMin,l.waveMediumAmplitudeMax),i=g(l.waveMediumFrequencyMin,l.waveMediumFrequencyMax),u=g(l.waveMediumRxMin,l.waveMediumRxMax),t=g(l.waveMediumRyMin,l.waveMediumRyMax);return I(g(l.waveMediumSyMin,l.waveMediumSyMax),e,n,g(l.waveMediumTimeMin,l.waveMediumTimeMax),d,i,u,t,v(S.Single,S.Quintuple))}if(e==D.Hard){const e=m(Y.Triangular,Y.Rectangular,Y.Circular),d=g(l.waveHardAmplitudeMin,l.waveHardAmplitudeMax),i=g(l.waveHardFrequencyMin,l.waveHardFrequencyMax),u=g(l.waveHardRxMin,l.waveHardRxMax),t=g(l.waveHardRyMin,l.waveHardRyMax);return I(g(l.waveHardSyMin,l.waveHardSyMax),e,n,g(l.waveHardTimeMin,l.waveHardTimeMax),d,i,u,t,v(S.Double,S.Sixtuple))}throw new Error}(q=F||(F={}))[q.Up=0]="Up",q[q.Left=1]="Left",q[q.Right=2]="Right",q[q.Down=3]="Down",function(e){e[e.Straight=0]="Straight",e[e.Triangular=1]="Triangular",e[e.Circular=2]="Circular",e[e.Rectangular=3]="Rectangular"}(Y||(Y={})),(O=D||(D={}))[O.Easy=0]="Easy",O[O.Medium=1]="Medium",O[O.Hard=2]="Hard";let U=0,z=1;function Q(e){z++;let n=D.Easy;z>3&&z<=6&&(n=D.Medium),z>6&&(n=D.Hard),e.entities=X(n).enemies,e.deadCount=0,U=0}function L(e){z=1,Q(e)}function $(e,n){e.dead=!0,n.deadCount++}const V={up:!1,down:!1,left:!1,right:!1,space:!1,shift:!1};function j(e){let n=!0;return()=>V[e]&&n?(n=!1,!0):(V[e]||(n=!0),!1)}onkeydown=onkeyup=e=>function(e,n){38!=e&&90!=e&&87!=e||(V.up=n);39!=e&&68!=e||(V.right=n);40!=e&&83!=e||(V.down=n);37!=e&&65!=e&&81!=e||(V.left=n);16==e&&(V.shift=n);32==e&&(V.space=n)}(e.keyCode,null!=e.type[5]);let G,J,K=null,N=(...e)=>{let n=K.createBufferSource(),d=K.createBuffer(e.length,e[0].length,ee);return e.map(((e,n)=>d.getChannelData(n).set(e))),n.buffer=d,n.connect(K.destination),n.start(),n},Z=(e=1,n=.05,d=220,i=0,u=0,t=.1,f=0,a=1,r=0,l=0,o=0,s=0,h=0,y=0,c=0,p=0,x=0,M=1,w=0,m=0)=>{let g,v,b=2*Math.PI,S=r*=500*b/ee**2,H=(0<c?1:-1)*b/4,P=d*=(1+2*n*Math.random()-n)*b/ee,R=[],T=0,E=0,B=0,A=1,C=0,W=0,F=0;for(l*=500*b/ee**3,c*=b/ee,o*=b/ee,s*=ee,h=ee*h|0,v=(i=99+ee*i)+(w*=ee)+(u*=ee)+(t*=ee)+(x*=ee)|0;B<v;R[B++]=F)++W%(100*p|0)||(F=f?1<f?2<f?3<f?Math.sin((T%b)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/b%2+2)%2:1-4*Math.abs(Math.round(T/b)-T/b):Math.sin(T),F=(h?1-m+m*Math.sin(2*Math.PI*B/h):1)*(0<F?1:-1)*Math.abs(F)**a*e*_*(B<i?B/i:B<i+w?1-(B-i)/w*(1-M):B<i+w+u?M:B<v-x?(v-B-x)/t*M:0),F=x?F/2+(x>B?0:(B<v-x?1:(v-B)/x)*R[B-x|0]/2):F),g=(d+=r+=l)*Math.sin(E*c-H),T+=g-g*y*(1-1e9*(Math.sin(B)+1)%2),E+=g-g*y*(1-1e9*(Math.sin(B)**2+1)%2),A&&++A>s&&(d+=o,P+=o,A=0),!h||++C%h||(d=P,r=S,A=A||1);return R},_=.3,ee=44100,ne=[[[.5,0,196,.05,.5,.6,1],[.8,undefined,24.5,.2,.3,.7,undefined,.5,undefined,undefined,5,undefined,.1,undefined,undefined,undefined,undefined,.8,undefined,.2],[2,0,196,.02,.1,.4,1],[,0,49,undefined,undefined,.2,3,5]],[[[,-1,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,1,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,12,undefined,undefined,undefined,undefined,undefined,undefined,undefined,17,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,undefined,3,undefined,undefined,undefined,undefined,undefined,undefined,undefined,5,undefined,undefined,undefined,undefined,undefined,undefined,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[2,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,15,15,undefined,13,undefined,10,undefined]],[[,-1,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,1,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,12,undefined,undefined,undefined,undefined,undefined,undefined,undefined,17,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,undefined,3,undefined,undefined,undefined,undefined,undefined,undefined,undefined,5,undefined,undefined,undefined,undefined,undefined,undefined,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[2,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,3,undefined,3,undefined,10,undefined,undefined,undefined,8,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,15,15,undefined,13,undefined,10,undefined],[3,undefined,8,undefined,undefined,undefined,8,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,undefined,3,undefined,undefined,15,15,undefined,13,undefined,10,undefined]],[[,-1,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,1,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,12,undefined,undefined,undefined,undefined,undefined,undefined,undefined,17,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,undefined,3,undefined,undefined,undefined,undefined,undefined,undefined,undefined,5,undefined,undefined,undefined,undefined,undefined,undefined,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[2,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,3,undefined,3,undefined,10,undefined,undefined,undefined,8,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,15,15,undefined,13,undefined,10,undefined],[3,undefined,8,undefined,undefined,undefined,8,undefined,10,undefined,undefined,undefined,1,3,undefined,undefined,8,undefined,1,3,undefined,undefined,1,undefined,3,undefined,undefined,15,15,undefined,13,undefined,10,undefined]]],[0,1,2,1,2],110,undefined];function de(){K=new window.AudioContext,G=((e,n,d,i=125)=>{let u,t,f,a,r,l,o,s,h,y,c,p,x,M,w,m=0,g=[],v=[],b=[],S=0,H=0,P=1,R={},T=ee/i*60>>2;for(;P;S++)g=[P=s=c=x=0],d.map(((i,c)=>{for(o=n[i][S]||[0,0,0],P|=!!n[i][S],w=x+(n[i][0].length-2-!s)*T,M=c==d.length-1,t=2,a=x;t<o.length+M;s=++t){for(r=o[t],h=t==o.length+M-1&&M||y!=(o[0]||0)|r|0,f=0;f<T&&s;f++>T-99&&h&&(p+=(p<1)/99))l=(1-p)*g[m++]/2||0,v[a]=(v[a]||0)-l*H+l,b[a]=(b[a++]||0)+l*H+l;r&&(p=r%1,H=o[1]||0,(r|=0)&&(g=R[[y=o[m=0]||0,r]]=R[[y,r]]||(u=[...e[y]],u[2]*=2**((r-12)/12),r>0?Z(...u):[])))}x=w}));return[v,b]})(...ne)}const ie=j("space"),ue=j("shift");h(l.playerWidth,l.playerHeight/2);let te,fe=!1,ae=!1;function re(e){let n=0,d=0;E(e.bullets),V.left&&(n+=-l.playerSpeedX),V.right&&(n+=l.playerSpeedX),V.up&&(d+=-l.playerSpeedY),V.down&&(d+=l.playerSpeedY),ie()&&function(e){null!=e.bullets.bullets.find((e=>!e.isActive))&&(T(e.bullets,e.dx+l.playerBulletSpeedX,y(e,h(l.playerWidth,l.playerHeight/2)),e.bulletsPattern),e.bulletsPattern+=1,e.bulletsPattern%=S.ConicEnd)}(e),e.dx=n,e.dy=d,ae||(de(),ae=!0),ae&&ue()&&(fe?J.stop():(K?.resume(),J=N(...G),J.loop=!0),fe=!fe),e.x+=e.dx*l.delta,e.y+=e.dy*l.delta,e.x<=0&&(e.x=0),e.x>=l.width-l.playerWidth&&(e.x=l.width-l.playerWidth),e.y<=0&&(e.y=0),e.y>=l.height-l.playerHeight&&(e.y=l.height-l.playerHeight)}function le(e){e.x=l.playerWidth,e.y=l.height/2,e.dx=0,e.dy=0}function oe(e,n){const d=ye(se(e),se(n)),i=ye(he(e),he(n));return null==d||null==i?null:{x:d.x,y:i.x,w:d.y-d.x,h:i.y-i.x}}function se(e){return{x:e.x,y:e.x+e.w}}function he(e){return{x:e.y,y:e.y+e.h}}function ye(e,n){return e.y<=n.x||n.y<=e.x?null:{x:Math.max(e.x,n.x),y:Math.min(e.y,n.y)}}var ce;(ce=te||(te={}))[ce.Speed=0]="Speed",ce[ce.Shield=1]="Shield",ce[ce.Multishot=2]="Multishot";let pe=0,xe=0,Me=0;window.onPowerUpChanged=function(e,n){e==te.Speed&&(pe+=n),e==te.Shield&&(xe+=n),e==te.Multishot&&(Me+=n),pe<0&&(pe=0),xe<0&&(xe=0),Me<0&&(Me=0),function(){const e=a("current-speed"),n=a("current-shield"),d=a("current-multishot");if(null==e||null==n||null==d)return;e.innerText=pe.toString(),n.innerText=xe.toString(),d.innerText=Me.toString()}()};let we=l.engineTimeResolution,me=performance.now(),ge=me;const ve={x:l.playerWidth,dx:0,y:l.height/2,dy:0,w:l.playerWidth,h:l.playerHeight,bullets:P(l.playerBulletsPoolSize,l.playerBulletSpeedX,l.playerBulletSpeedY,l.playerSprayOpen),bulletsPattern:S.Single},be=function(){const e=`#${b()}`;return{x:.5*l.width-l.bossWidth/2,y:.5*l.height-l.bossHeight/2,w:l.bossWidth,h:l.bossHeight,dx:0,dy:0,color:e,bullets:P(l.bossBulletsPoolSize,l.bossBulletSpeedX,l.bossBulletSpeedY,l.bossSprayOpen),elapsedTime:0,currentPattern:C,shootElapsedTime:0,newPatternTime:0,shootCount:0,targetReached:!1,patternIndex:0,repeatCount:0}}(),Se={entities:X(D.Easy).enemies,deadCount:0},He={canvas:o(l.width,l.height,"gameCanvas")};function Pe(){re(ve),function(e){E(e.bullets),e.elapsedTime+=l.delta,e.shootElapsedTime+=l.delta;const i=l.bossSpeed;if(0!=e.newPatternTime){if(!(e.elapsedTime>=e.newPatternTime))return;e.newPatternTime=0,e.currentPattern==A?e.currentPattern=C:e.currentPattern==C?e.currentPattern=W:e.currentPattern==W&&(e.currentPattern=A)}if(e.targetReached?(e.y>.9*l.height-l.bossHeight||e.y<.1*l.height)&&(e.dy*=-1):(e.x>e.currentPattern.tx?e.dx=-i:e.x<e.currentPattern.tx&&(e.dx=i),e.y>e.currentPattern.ty?e.dy=-i:e.y<e.currentPattern.ty&&(e.dy=i)),e.x+=e.dx*l.delta,e.y+=e.dy*l.delta,e.targetReached)if(e.shootCount<e.currentPattern.shootCount[e.patternIndex])e.shootElapsedTime>=1/e.currentPattern.shootFrequency[e.patternIndex]&&(e.shootCount+=1,e.shootElapsedTime=0,null!=e.currentPattern.shootPattern[e.patternIndex]&&T(e.bullets,e.dx-e.currentPattern.shootSpeed[e.patternIndex],y(e,h(0,l.bossHeight/2)),e.currentPattern.shootPattern[e.patternIndex],e.currentPattern.shootRandom[e.patternIndex]));else if(e.shootCount=0,e.bullets.lastRandY=0,e.patternIndex+1==e.currentPattern.shootFrequency.length){if(e.patternIndex=0,e.repeatCount+1==e.currentPattern.repeat)return e.repeatCount=0,e.targetReached=!1,void(e.newPatternTime=e.elapsedTime+e.currentPattern.waitTime);e.repeatCount+=1,e.currentPattern.resetPosOnRepeat&&(e.targetReached=!1)}else e.patternIndex+=1;else if(!(n(e.x)!=e.currentPattern.tx&&d(e.x)!=e.currentPattern.tx||n(e.y)!=e.currentPattern.ty&&d(e.y)!=e.currentPattern.ty))e.targetReached=!0,e.dx=e.currentPattern.dx,e.dy=e.currentPattern.dy}(be),function(e,n){for(let d of function(e){return e.entities.filter((e=>!e.dead))}(n)){for(let i of e.bullets.bullets)null!=oe(d,i)&&(M(i),$(d,n));for(let i of d.bullets.bullets)null!=oe(e,i)&&(L(n),le(e));null!=oe(e,d)&&(le(e),L(n))}}(ve,Se)}!function e(d){window.requestAnimationFrame((n=>e(n)));var i,u,t=0;d>me+we&&(t=n((d-me)/we));for(var f=0;f<t;f++)me+=we,Pe();(function({canvas:e}){e.clearRect(0,0,l.width,l.height)})(He),function(e,n){s(e,n);for(let d of n.bullets.bullets)d.isActive&&p(e,d)}(He,ve),B(i=He,(u=be).bullets),s(i,u,u.color),ge=d}(0);