function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},r={},a=n.parcelRequired7fa;function l(e){return Math.round(e)}function o(e){return Math.floor(e)}function s(e){return Math.ceil(e)}function u(e,t){return Math.min(e,t)}function d(e){return Math.cos(e)}function h(e){return Math.sin(e)}function c(e,t){return Math.pow(e,t)}function y(e){return document.getElementById(e)}null==a&&((a=function(e){if(e in i)return i[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},n.parcelRequired7fa=a),a.register("dRo73",(function(t,n){var i,r;e(t.exports,"register",(()=>i),(e=>i=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var a={};i=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)a[t[n]]=e[t[n]]},r=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a("dRo73").register(JSON.parse('{"1MGML":"index.3b9bf0a6.js","fnLwo":"texture.a4f34072.png"}'));const p=Math.PI;var f;f=JSON.parse('{"frames":{"assets/boss.png":{"frame":{"x":0,"y":0,"w":28,"h":38},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":28,"h":38},"sourceSize":{"w":28,"h":38},"pivot":{"x":0.5,"y":0.5}},"assets/cerbere.png":{"frame":{"x":28,"y":0,"w":20,"h":17},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":17},"sourceSize":{"w":20,"h":17},"pivot":{"x":0.5,"y":0.5}},"assets/friendly_vertical_laser.png":{"frame":{"x":28,"y":17,"w":7,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":16},"sourceSize":{"w":7,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/border1.png":{"frame":{"x":0,"y":38,"w":16,"h":14},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":2,"w":16,"h":14},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/vertical_laser.png":{"frame":{"x":28,"y":33,"w":7,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":16},"sourceSize":{"w":7,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/skeleton.png":{"frame":{"x":35,"y":17,"w":13,"h":16},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":1,"y":0,"w":13,"h":16},"sourceSize":{"w":15,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/imp.png":{"frame":{"x":35,"y":33,"w":10,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":10,"h":16},"sourceSize":{"w":10,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/border2.png":{"frame":{"x":48,"y":0,"w":16,"h":11},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":5,"w":16,"h":11},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/zombie.png":{"frame":{"x":45,"y":33,"w":11,"h":16},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":11,"h":16},"sourceSize":{"w":11,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/floating_eye.png":{"frame":{"x":48,"y":11,"w":14,"h":13},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":14,"h":13},"sourceSize":{"w":14,"h":13},"pivot":{"x":0.5,"y":0.5}},"assets/power_up_multi_shot.png":{"frame":{"x":16,"y":38,"w":9,"h":13},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":1,"w":9,"h":13},"sourceSize":{"w":16,"h":16},"pivot":{"x":0.5,"y":0.5}},"assets/friendly_vertical_laser_top.png":{"frame":{"x":56,"y":24,"w":7,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":5},"sourceSize":{"w":7,"h":5},"pivot":{"x":0.5,"y":0.5}},"assets/vertical_laser_top.png":{"frame":{"x":48,"y":24,"w":7,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":7,"h":5},"sourceSize":{"w":7,"h":5},"pivot":{"x":0.5,"y":0.5}},"assets/friendly_bullet.png":{"frame":{"x":56,"y":29,"w":5,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":5,"h":5},"sourceSize":{"w":5,"h":5},"pivot":{"x":0.5,"y":0.5}},"assets/enemie_bullet.png":{"frame":{"x":56,"y":34,"w":5,"h":5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":5,"h":5},"sourceSize":{"w":5,"h":5},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":64,"h":52},"scale":1}}');var x;x=new URL(a("dRo73").resolve("fnLwo"),import.meta.url).toString();const m={debug:!1,width:960,height:640,tileSize:16,worldWidth:30,worldHeight:12,playerSpeedX:300,playerSpeedY:300,playerWidth:50,playerHeight:50,playerBulletSpeedX:200,playerBulletSpeedY:100,playerBulletsPoolSize:200,playerSprayOpen:3,playerBulletWidth:5,playerBulletHeight:5,enemyWidth:50,enemyHeight:50,enemyBulletSpeedX:150,enemyBulletSpeedY:50,enemyBulletsPoolSize:50,enemyShootFrequency:1,enemyBulletPoolSize:1e3,enemySprayOpen:1,bossWidth:150,bossHeight:150,bossRxMin:100,bossRxMax:200,bossRyMin:100,bossRyMax:200,bossSpeed:300,bossBulletSpeedX:100,bossBulletSpeedY:100,bossBulletsPoolSize:200,bossBigBulletWidth:25,bossBigBulletHeight:25,bossBigBulletExplosionTick:200,bossPatternFrequency:5,bossSprayOpen:2,bossLife:100,bulletWidth:5,bulletHeight:5,bulletMaxHeight:500,bulletsVariance:20,bulletsMaxdY:200,waveEasyCount:3,waveEasyTimeMin:4,waveEasyTimeMax:6,waveEasyAmplitudeMin:10,waveEasyAmplitudeMax:50,waveEasyFrequencyMin:.1,waveEasyFrequencyMax:.25,waveEasyRxMin:100,waveEasyRxMax:200,waveEasyRyMin:100,waveEasyRyMax:200,waveEasySyMin:0,waveEasySyMax:590,waveMediumCount:3,waveMediumTimeMin:4,waveMediumTimeMax:6,waveMediumAmplitudeMin:10,waveMediumAmplitudeMax:50,waveMediumFrequencyMin:.1,waveMediumFrequencyMax:.25,waveMediumRxMin:100,waveMediumRxMax:200,waveMediumRyMin:100,waveMediumRyMax:200,waveMediumSyMin:0,waveMediumSyMax:590,waveHardCount:3,waveHardTimeMin:4,waveHardTimeMax:6,waveHardAmplitudeMin:10,waveHardAmplitudeMax:50,waveHardFrequencyMin:.1,waveHardFrequencyMax:.25,waveHardRxMin:100,waveHardRxMax:200,waveHardRyMin:100,waveHardRyMax:200,waveHardSyMin:0,waveHardSyMax:590,powerUpMaxCount:5,engineTimeResolution:1,epsilon:.1,delta:.001};function w(e,t){const n=new Image(151,151);return n.src=e,t&&(n.onload=t),n}function g(e,t,n=null){const i=null==n?(r="canvas",document.createElement(r)):y(n);var r;i.width=e,i.height=t;return i.getContext("2d")}function M({canvas:e,image:n},{x:i,y:r},a){if(!n.complete)return;const l=t(f).frames[a].frame;e.drawImage(n,l.x,l.y,l.w,l.h,i,r,l.w,l.h)}function S({canvas:e},{x:t,y:n,w:i,h:r},a="#FF0000"){e&&(e.fillStyle=a),e.fillRect(l(t),l(n),i,r)}function b(e,t){return{x:e,y:t}}function v(e,t){return b(e.x+t.x,e.y+t.y)}function H(e=m.bulletHeight,t=m.bulletWidth,n=!1){return{x:0,y:0,w:t,h:e,dx:0,dy:0,isActive:!1,dh:0,dhDirection:0,explodeTick:0,bullets:void 0,shielded:n}}function R(e){if(!e.isActive)return;e.x+=e.dx*m.delta;const t=e.h;if(e.h=u(e.h+e.dh,m.bulletMaxHeight),e.h==m.bulletMaxHeight&&(e.dy=-30*h(e.x/m.width*6*p)),e.y+=e.dy*m.delta-(e.h-t)*e.dhDirection,0!=e.explodeTick&&(e.explodeTick-=1,0==e.explodeTick)){if(null==e.bullets)return void E(e);const t=e.dx/2;for(let n=0;n<4;n++){let i=e.bullets.bullets.find((e=>!e.isActive));if(null==i)return void E(e);P(e.bullets,i,e,b(c(-1,n)*t,c(-1,o(n/2))*t+e.dy))}E(e)}(e.x<0||e.x>m.width)&&E(e),e.h==m.bulletHeight&&(e.y+e.h/2<0||e.y>m.height+e.h/2)&&E(e)}function T(e,t){t.isActive&&S(e,t)}function P(e,t,n,i){t.x=n.x,t.y=n.y,t.dx=i.x,t.dy=i.y,t.isActive=!0,t.bullets=e}function E(e){e.isActive=!1,e.dx=0,e.dy=0,e.x=0,e.y=0,e.h=e.bullets?.bh??0,e.w=e.bullets?.bw??0,e.dh=0,e.shielded=e.bullets?.shielded}function C(e,t){const n=[];for(let i=0;i<t;i++)n.push(e());return n}function B(...e){return e[Math.floor(Math.random()*e.length)]}function z(e,t){return Math.random()*(t-e)+e}function A(e,t){return e=Math.ceil(e),t=Math.floor(t)+1,Math.floor(Math.random()*(t-e)+e)}function W(){return Math.floor(16777215*Math.random()).toString(16)}let F;var q;function _(e,t,n,i,r,a,l=!1){return{bullets:C((()=>H(r,a,l)),e),baseSpeedX:t,baseSpeedY:n,lastRandY:0,sprayOpen:i,shielded:l,bh:r,bw:a}}function D(e,t){let n=z(-t,t),i=e.lastRandY+n;var r,a;return r=u(m.bulletsMaxdY,i),a=-m.bulletsMaxdY,i=Math.max(r,a),e.lastRandY=i,i}function Y(e,t,n,i,r=0){let a=D(e,r);if(i<F.ConicEnd)for(let l=0;l<=i;l++){let o=e.bullets.find((e=>!e.isActive));if(null==o)return;P(e,o,n,b(t,e.baseSpeedY*d(p*((l+1)/(i+2)))*e.sprayOpen+a)),a=D(e,r)}if(i==F.Straight){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;i.dh=.1,P(e,i,n,b(t,a))}if(i==F.StraightHole){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;if(i.dh=.4,i.dhDirection=0,P(e,i,n,b(t,a+150*i.dh+10)),i=e.bullets.find((e=>!e.isActive)),null==i)return;i.dh=.4,i.dhDirection=1,P(e,i,n,b(t,a-(150*i.dh+10)))}if(i==F.Explosion){let i=e.bullets.find((e=>!e.isActive));if(null==i)return;i.w=m.bossBigBulletWidth,i.h=m.bossBigBulletHeight,i.bullets=e,i.explodeTick=m.bossBigBulletExplosionTick,P(e,i,v(n,b(m.bossBigBulletWidth,-m.bossBigBulletHeight/2)),b(t,a))}if(i==F.UpAndDown){for(let l=0;l<=10;l++){let o=e.bullets.find((e=>!e.isActive));if(null==o)return;P(e,o,v(n,b(m.bossWidth/2,m.bossHeight/2)),b(t*d(p*((l+1)/(i+2)))*.5+a,e.baseSpeedY)),a=D(e,r)}for(let l=0;l<=10;l++){let o=e.bullets.find((e=>!e.isActive));if(null==o)return;P(e,o,v(n,b(m.bossWidth/2,-m.bossHeight/2)),b(t*d(p*((l+1)/(i+2)))*.5+a,-e.baseSpeedY)),a=D(e,r)}}}function O(e){for(let t of U(e))R(t)}function I(e,t){for(let n of U(t))T(e,n)}function U(e){return e.bullets.filter((e=>e.isActive))}function k(e){for(let t of e.bullets)E(t)}(q=F||(F={}))[q.Single=0]="Single",q[q.Double=1]="Double",q[q.Triple=2]="Triple",q[q.Quadruple=3]="Quadruple",q[q.Quintuple=4]="Quintuple",q[q.Sixtuple=5]="Sixtuple",q[q.ConicEnd=6]="ConicEnd",q[q.Straight=7]="Straight",q[q.StraightHole=8]="StraightHole",q[q.Explosion=9]="Explosion",q[q.UpAndDown=10]="UpAndDown";const L={waitTime:2,tx:.8*m.width-m.bossWidth,ty:.5*m.height-m.bossHeight/2,dx:5,dy:15,shootPattern:[F.Sixtuple,F.Quintuple,F.Triple,F.UpAndDown],shootCount:[4,3,5,5],shootFrequency:[4,3,2,5],shootSpeed:[200,120,250,50],shootRandom:[150,300,300,150],repeat:3,resetPosOnRepeat:!0},X={waitTime:3,tx:m.width-m.bossWidth,ty:.2*m.height,dx:0,dy:60,shootPattern:[F.UpAndDown,F.StraightHole],shootCount:[5,40],shootFrequency:[5,3],shootSpeed:[200,100],repeat:1,shootRandom:[0,20],resetPosOnRepeat:!0},G={waitTime:0,tx:m.width-m.bossWidth,ty:.5*m.height-m.bossHeight,dx:-50,dy:0,shootPattern:[F.Explosion,F.Double],shootCount:[10,5],shootFrequency:[3,5],shootSpeed:[500,600],repeat:2,shootRandom:[600,100],resetPosOnRepeat:!0};function Q(){const e=`#${W()}`;return{x:.5*m.width-m.bossWidth/2,y:.5*m.height-m.bossHeight/2,w:m.bossWidth,h:m.bossHeight,dx:0,dy:0,color:e,bullets:_(m.bossBulletsPoolSize,m.bossBulletSpeedX,m.bossBulletSpeedY,m.bossSprayOpen,m.bulletWidth,m.bulletHeight),elapsedTime:0,currentPattern:X,shootElapsedTime:0,newPatternTime:0,shootCount:0,targetReached:!1,patternIndex:0,repeatCount:0,life:m.bossLife}}function N(e){O(e.bullets),e.elapsedTime+=m.delta,e.shootElapsedTime+=m.delta;const t=m.bossSpeed;if(0!=e.newPatternTime){if(!(e.elapsedTime>=e.newPatternTime))return;e.newPatternTime=0,e.currentPattern==L?e.currentPattern=X:e.currentPattern==X?e.currentPattern=G:e.currentPattern==G&&(e.currentPattern=L)}if(e.targetReached?(e.y>.9*m.height-m.bossHeight||e.y<.1*m.height)&&(e.dy*=-1):(e.x>e.currentPattern.tx?e.dx=-t:e.x<e.currentPattern.tx&&(e.dx=t),e.y>e.currentPattern.ty?e.dy=-t:e.y<e.currentPattern.ty&&(e.dy=t)),e.x+=e.dx*m.delta,e.y+=e.dy*m.delta,e.targetReached)if(e.shootCount<e.currentPattern.shootCount[e.patternIndex])e.shootElapsedTime>=1/e.currentPattern.shootFrequency[e.patternIndex]&&(e.shootCount+=1,e.shootElapsedTime=0,null!=e.currentPattern.shootPattern[e.patternIndex]&&Y(e.bullets,e.dx-e.currentPattern.shootSpeed[e.patternIndex],v(e,b(0,m.bossHeight/2)),e.currentPattern.shootPattern[e.patternIndex],e.currentPattern.shootRandom[e.patternIndex]));else if(e.shootCount=0,e.bullets.lastRandY=0,e.patternIndex+1==e.currentPattern.shootFrequency.length){if(e.patternIndex=0,e.repeatCount+1==e.currentPattern.repeat)return e.repeatCount=0,e.targetReached=!1,void(e.newPatternTime=e.elapsedTime+e.currentPattern.waitTime);e.repeatCount+=1,e.currentPattern.resetPosOnRepeat&&(e.targetReached=!1)}else e.patternIndex+=1;else if(!(o(e.x)!=e.currentPattern.tx&&s(e.x)!=e.currentPattern.tx||o(e.y)!=e.currentPattern.ty&&s(e.y)!=e.currentPattern.ty))return e.targetReached=!0,e.dx=e.currentPattern.dx,void(e.dy=e.currentPattern.dy)}function j(e,t){I(e,t.bullets),S(e,t,t.color)}function J(e){e.x=.5*m.width-m.bossWidth/2,e.y=.5*m.height-m.bossHeight/2,e.dx=0,e.dy=0,k(e.bullets),e.elapsedTime=0,e.currentPattern=X,e.shootElapsedTime=0,e.newPatternTime=0,e.shootCount=0,e.targetReached=!1,e.patternIndex=0,e.repeatCount=0}let $;var V;let K;function Z(e,t,n,i,r,a,l,o,s=F.Single,u){return{x:m.width,y:e,sy:e,dx:0,dy:0,w:m.enemyWidth,h:m.enemyHeight,pattern:t,time:i,color:n,dead:!1,amplitude:r,frequency:a,rx:l,ry:o,elapsedTime:0,shootElapsedTime:0,distance:0,direction:$.Left,bullets:_(m.enemyBulletsPoolSize,m.enemyBulletSpeedX,m.enemyBulletSpeedY,m.enemySprayOpen,m.bulletWidth,m.bulletHeight),bulletsPattern:s,sprite:u}}function ee(e){if(O(e.bullets),e.dead)return;const t=e.frequency,n=e.amplitude,i=(m.width+m.enemyWidth)/e.time;e.elapsedTime+=m.delta,e.shootElapsedTime+=m.delta,e.pattern==K.Circular&&(e.dx=2*p*t*n*d(2*p*t*e.elapsedTime)-i,e.dy=2*p*t*n*h(2*p*t*e.elapsedTime)),e.pattern==K.Rectangular&&(null==e.direction&&(e.direction=$.Left),e.direction==$.Left&&(e.distance>=e.rx&&(e.direction=B($.Up,$.Down),e.distance=0),e.dx=-i,e.dy=0,e.distance+=-e.dx*m.delta),e.direction,$.Right,e.direction==$.Up&&(e.distance>=e.ry&&(e.direction=$.Left,e.distance=0),e.dy=-i/2,e.dx=0,e.distance+=-e.dy*m.delta),e.direction==$.Down&&(e.distance>=e.ry&&(e.direction=$.Left,e.distance=0),e.dy=i/2,e.dx=0,e.distance+=e.dy*m.delta)),e.pattern==K.Triangular&&(e.y>=e.sy+n&&(e.dy=-4*n*t),(0==e.dy||e.y<=e.sy-n)&&(e.dy=4*n*t),e.dx=-i),e.pattern==K.Straight&&(e.dx=-i),e.x+=e.dx*m.delta,e.y+=e.dy*m.delta,e.shootElapsedTime>=1/m.enemyShootFrequency&&(e.shootElapsedTime=0,Y(e.bullets,-i-m.enemyBulletSpeedX,v(e,b(0,m.enemyHeight/2)),e.bulletsPattern))}function te(e,t){I(e,t.bullets),t.dead||(m.debug?S(e,t,t.color):M(e,t,t.sprite))}(V=$||($={}))[V.Up=0]="Up",V[V.Left=1]="Left",V[V.Right=2]="Right",V[V.Down=3]="Down",function(e){e[e.Straight=0]="Straight",e[e.Triangular=1]="Triangular",e[e.Circular=2]="Circular",e[e.Rectangular=3]="Rectangular"}(K||(K={}));const ne={up:!1,down:!1,left:!1,right:!1,space:!1,shift:!1,m:!1};function ie(e){let t=!0;return()=>ne[e]&&t?(t=!1,!0):(ne[e]||(t=!0),!1)}onkeydown=onkeyup=e=>function(e,t){38!=e&&90!=e&&87!=e||(ne.up=t);39!=e&&68!=e||(ne.right=t);40!=e&&83!=e||(ne.down=t);37!=e&&65!=e&&81!=e||(ne.left=t);16==e&&(ne.shift=t);32==e&&(ne.space=t);77==e&&(ne.m=t)}(e.keyCode,null!=e.type[5]);let re,ae,le,oe,se,ue=null,de=(...e)=>{let t=ue.createBufferSource(),n=ue.createBuffer(e.length,e[0].length,ye);return e.map(((e,t)=>n.getChannelData(t).set(e))),t.buffer=n,t.connect(ue.destination),t.start(),t},he=(e=1,t=.05,n=220,i=0,r=0,a=.1,l=0,o=1,s=0,u=0,d=0,h=0,c=0,y=0,p=0,f=0,x=0,m=1,w=0,g=0)=>{let M,S,b=2*Math.PI,v=s*=500*b/ye**2,H=(0<p?1:-1)*b/4,R=n*=(1+2*t*Math.random()-t)*b/ye,T=[],P=0,E=0,C=0,B=1,z=0,A=0,W=0;for(u*=500*b/ye**3,p*=b/ye,d*=b/ye,h*=ye,c=ye*c|0,S=(i=99+ye*i)+(w*=ye)+(r*=ye)+(a*=ye)+(x*=ye)|0;C<S;T[C++]=W)++A%(100*f|0)||(W=l?1<l?2<l?3<l?Math.sin((P%b)**3):Math.max(Math.min(Math.tan(P),1),-1):1-(2*P/b%2+2)%2:1-4*Math.abs(Math.round(P/b)-P/b):Math.sin(P),W=(c?1-g+g*Math.sin(2*Math.PI*C/c):1)*(0<W?1:-1)*Math.abs(W)**o*e*ce*(C<i?C/i:C<i+w?1-(C-i)/w*(1-m):C<i+w+r?m:C<S-x?(S-C-x)/a*m:0),W=x?W/2+(x>C?0:(C<S-x?1:(S-C)/x)*T[C-x|0]/2):W),M=(n+=s+=u)*Math.sin(E*p-H),P+=M-M*y*(1-1e9*(Math.sin(C)+1)%2),E+=M-M*y*(1-1e9*(Math.sin(C)**2+1)%2),B&&++B>h&&(n+=d,R+=d,B=0),!c||++z%c||(n=R,s=v,B=B||1);return T},ce=.3,ye=44100,pe=(e,t,n,i=125)=>{let r,a,l,o,s,u,d,h,c,y,p,f,x,m,w,g=0,M=[],S=[],b=[],v=0,H=0,R=1,T={},P=ye/i*60>>2;for(;R;v++)M=[R=h=p=x=0],n.map(((i,p)=>{for(d=t[i][v]||[0,0,0],R|=!!t[i][v],w=x+(t[i][0].length-2-!h)*P,m=p==n.length-1,a=2,o=x;a<d.length+m;h=++a){for(s=d[a],c=a==d.length+m-1&&m||y!=(d[0]||0)|s|0,l=0;l<P&&h;l++>P-99&&c&&(f+=(f<1)/99))u=(1-f)*M[g++]/2||0,S[o]=(S[o]||0)-u*H+u,b[o]=(b[o++]||0)+u*H+u;s&&(f=s%1,H=d[1]||0,(s|=0)&&(M=T[[y=d[g=0]||0,s]]=T[[y,s]]||(r=[...e[y]],r[2]*=2**((s-12)/12),s>0?he(...r):[])))}x=w}));return[S,b]},fe=[[[,0,261,,,2,2,,,,,,,,,,.01],[,0,32,.05,,.2,3,5],[3,0,43,,,.25,,,,,,,,2],[1.6,0,655,,,,3,1.65,,,,,.02,3.8,-.1,,.2],[,0,232,.01,.09,.15,2,,,,,,154.87,,,,.26]],[[[,,4,,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,4,,,,,,3,,,,,,,,,,,,,,,,,,,,,,3,,,,],[,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,,,,,,,,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,10,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[2,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[4,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,,,,,,,,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,22,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[2,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,,,]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[4,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,,,,,,,,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,22,,,,,,,,],[,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,16,,,,,,15,,,,,,,,,,,,,,,,,,,,,,,,,,],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[4,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,,,,,,,,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,15,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,13]],[[,,4,,,,,,3,,,,,,,,,,3,,3,,3,,3,,3,,3,,3,,,,4,,,,,,3,,,,,,,,,,4,,3,,3,,3,,3,,3,,3,,,,],[4,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,,,,,,,,,,,,,,,,,,,,,25,24,25,24,,,,,25,24,25,24,22,,,,,,,,],[4,,13,13,13,13,13,13,12,12,12,12,12,12,12,,,,12,12,12,12,,,,,12,12,12,12,12,12,12,12,13,13,13,13,13,13,10,10,10,10,10,10,,,,,10,10,10,10,,,,,,10,10,10,10,10,10,10],[1,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,3,,],[4,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,,,,,,,,,,,,,,,,,,,,,30,29,30,29,,,,,18,17,18,17,15,,,,,,,,],[3,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,,,,,,13,,,,,,,,13,,,,,,,,13,,,,,,,,13,,13,13]]],[0,1,1,2,2,3,3,4,4,5,5,3,3,4,4,5,5,2,2],135,undefined],xe=[[[.5,0,128,,.08,.5,3],[.8,0,32,,.07,.11,2,0,,,.5,.01],[2,0,4e3,,,.03,2,1.25,,,,,.02,6.8,-.3,,.5],[.9,0,32,,,.35,3,2]],[[[1,,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,15,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,21],[,,15,,20,15,,18,,,,,,,21,16,15,,15,,20,15,,20,,,,,,,23,18,15,,],[2,,,,,,,,,,13,13,13,13,,,,,,,,,,,,,1,1,1,1,,,,,]],[[1,,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,15,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,21],[,,15,,20,15,,18,,,,,,,21,16,15,,15,,20,15,,20,,,,,,,23,18,15,,],[2,,,,,,,,,,13,13,13,13,,,,,,,,,,,,,1,1,1,1,,,,,],[3,,20,,,,20,,,,20,,,,20,,15,,13,,,,13,,,,13,,,,13,,16,,]],[[1,,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,15,13,13,15,13,13,13,15,16,13,13,15,13,13,13,16,21]]],[2,2,0,0,1,0,1,0,1,0],80],me=[[[1.5,0,130,,,.5,,,,,,,,,,,,.15,.6],[,0,130,.01,.09,.15,2,,,,,,154.87,,,,.26],[1.4,0,32,,,.25,3,5]],[[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[1,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,10,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,13,,],[,,36,32,34,,,,,,29,25,27,,,,,,22,,,,22,,,,,,,,,,,,22,25,24,,,,,,29,32,30,,,,,,25,,,,25,,,,25,,,,25,,,,],[2,,12,,12,,12,,12,,12,,12,,12,,12,,10,,10,,10,,10,,10,,10,,10,,10,,12,,12,,12,,12,,12,,12,,12,,12,,10,,10,,10,,10,,10,,10,,10,,5,,]],[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[1,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,10,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,13,,],[,,36,32,34,,,,,,29,25,27,,,,,,22,,,,22,,,,,,,,,,,,22,25,24,,,,,,29,32,30,,,,,,25,,,,25,,,,25,,,,25,,,,]],[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[,,36,32,34,,,,,,29,25,27,,,,,,22,,,,22,,,,,,,,,,,,22,25,24,,,,,,29,32,30,,,,,,25,,,,25,,,,25,,,,25,,,,]],[[,,24,,,,20,,,,17,,,,13,,,,10,,,,10,,,,10,,,,10,,,,13,,,,17,,,,20,,,,24,,,,10,,,,10,,,,10,,,,13,,,,],[1,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,10,,24,20,22,18,20,17,18,15,17,13,15,12,13,10,12,8,10,10,,,10,10,,,10,10,,,10,,13,,]]],[2,3,3,1,1,0,0,0,0,0,0],120],we=[[[1.5,0,32,.05,.25,,3,3,,,,,,,,,3,.6],[,0,128,,,.2,2,,,,,,,,,.02,.01],[,0,1024,,,.3,2,.2,-.1,-.15,9,.02,,.1,.12,,.06]],[[[,,13,,13,,,,,,6,,6,,,,,,8,,8,,,,,,3,,3,,,,,,],[1,,25,,25,,25,,25,,18,,18,,18,,18,,12,,12,,12,,12,,3,,3,,3,,3,,],[1,,22,,22,,22,,22,,15,,15,,15,,15,,8,,8,,8,,8,,6,,6,,6,,6,,],[2,,25,22,,,,,,,15,18,,15,,,,,12,,,,,,,,6,,6,6,,3,,,]],[[,,13,,13,,,,,,6,,6,,,,,,8,,8,,,,,,3,,3,,,,,,],[1,,25,,25,,25,,25,,18,,18,,18,,18,,12,,12,,12,,12,,3,,3,,3,,3,,],[1,,22,,22,,22,,22,,15,,15,,15,,15,,8,,8,,8,,8,,6,,6,,6,,6,,],[2,,25,22,,,,,,,15,15,,18,,,,,8,8,,12,,,,,6,,6,6,,3,,,]],[[,,13,,13,,,,,,6,,6,,,,,,8,,8,,,,,,3,,3,,,,,,],[1,,25,,,,,,,,18,,,,18,,,,12,,,,,,,,3,,,,3,,,,],[1,,22,,,,22,,,,15,,,,,,,,8,,,,8,,,,6,,,,,,,,]]],[2,2,0,1,0,1],120];var ge;(ge=se||(se={}))[ge.Speed=0]="Speed",ge[ge.Shield=1]="Shield",ge[ge.Multishot=2]="Multishot";let Me=0,Se=0,be=0,ve=null;function He(e){y("ui-shop").style.display=e?"flex":"none"}function Re(e){y("current-money").innerText=e.toString()}window.onPowerUpChanged=function(e,t){const n=ve.player;Fe(n,-t)&&(e==se.Speed&&(Me+=t),e==se.Shield&&(Se+=t),e==se.Multishot&&(be+=t),Me<0&&(Me=0,Fe(n,t)),Se<0&&(Se=0,Fe(n,t)),be<0&&(be=0,Fe(n,t)),y("current-speed").innerText=Me.toString(),y("current-shield").innerText=Se.toString(),y("current-multishot").innerText=be.toString())},window.play=function(){nt(Oe.Game,ve)};const Te=ie("space"),Pe=ie("shift");let Ee,Ce=!1,Be=!1;function ze(e){let t=0,n=0;O(e.bullets),ne.left&&(t+=-m.playerSpeedX),ne.right&&(t+=m.playerSpeedX),ne.up&&(n+=-m.playerSpeedY),ne.down&&(n+=m.playerSpeedY),Te()&&function(e){null!=e.bullets.bullets.find((e=>!e.isActive))&&Y(e.bullets,e.shootSpeed*m.playerBulletSpeedX,v(e,b(m.playerWidth,m.playerHeight/2)),e.bulletsPattern)}(e),e.dx=t,e.dy=n,Be||(ue=new window.AudioContext,ae=pe(...me),re=[pe(...fe),pe(...xe)],le=pe(...we),Be=!0),Be&&Pe()&&(Ce?oe.stop():(ue?.resume(),oe=de(...re[A(0,1)]),oe.loop=!0),Ce=!Ce),e.x+=e.dx*m.delta,e.y+=e.dy*m.delta,e.x<=0&&(e.x=0),e.x>=m.width-m.playerWidth&&(e.x=m.width-m.playerWidth),e.y<=0&&(e.y=0),e.y>=m.height-m.playerHeight&&(e.y=m.height-m.playerHeight)}function Ae(e){e.x=m.playerWidth,e.y=m.height/2,e.dx=0,e.dy=0;let t=[Me,Se,be];e.shootSpeed=t[se.Speed]+1,e.shieldCount=t[se.Shield]+1,e.shieldCount=5,e.shieldCount==m.powerUpMaxCount&&(e.bullets.shielded=!0),t[se.Multishot]==m.powerUpMaxCount?e.bulletsPattern=F.Straight:e.bulletsPattern=t[se.Multishot]}function We(e){return e.shieldCount-=1,e.shieldCount}function Fe(e,t){return!(e.money+t<0)&&(e.money+=t,Re(e.money),!0)}var qe;(qe=Ee||(Ee={}))[qe.Easy=0]="Easy",qe[qe.Medium=1]="Medium",qe[qe.Hard=2]="Hard";let _e=["assets/floating_eye.png","assets/imp.png","assets/skeleton.png","assets/zombie.png"];function De(e){const t=[];if(e==Ee.Easy){const n=A(3,6);for(let i=0;i<n;i++)t.push(Ye(e))}if(e==Ee.Medium){const n=A(5,10);for(let i=0;i<n;i++)t.push(Ye(e))}if(e==Ee.Hard){const n=A(9,17);for(let i=0;i<n;i++)t.push(Ye(e))}return{difficulty:e,enemies:t}}function Ye(e){const t=`#${W()}`;if(e==Ee.Easy){const e=B(K.Straight,K.Triangular),n=z(m.waveEasyAmplitudeMin,m.waveEasyAmplitudeMax),i=z(m.waveEasyFrequencyMin,m.waveEasyFrequencyMax),r=z(m.waveEasyRxMin,m.waveEasyRxMax),a=z(m.waveEasyRyMin,m.waveEasyRyMax);return Z(z(m.waveEasySyMin,m.waveEasySyMax),e,t,z(m.waveEasyTimeMin,m.waveEasyTimeMax),n,i,r,a,A(F.Single,F.Double),B(..._e))}if(e==Ee.Medium){const e=B(K.Straight,K.Triangular,K.Rectangular),n=z(m.waveMediumAmplitudeMin,m.waveMediumAmplitudeMax),i=z(m.waveMediumFrequencyMin,m.waveMediumFrequencyMax),r=z(m.waveMediumRxMin,m.waveMediumRxMax),a=z(m.waveMediumRyMin,m.waveMediumRyMax);return Z(z(m.waveMediumSyMin,m.waveMediumSyMax),e,t,z(m.waveMediumTimeMin,m.waveMediumTimeMax),n,i,r,a,A(F.Single,F.Quintuple),B(..._e))}if(e==Ee.Hard){const e=B(K.Triangular,K.Rectangular,K.Circular),n=z(m.waveHardAmplitudeMin,m.waveHardAmplitudeMax),i=z(m.waveHardFrequencyMin,m.waveHardFrequencyMax),r=z(m.waveHardRxMin,m.waveHardRxMax),a=z(m.waveHardRyMin,m.waveHardRyMax);return Z(z(m.waveHardSyMin,m.waveHardSyMax),e,t,z(m.waveHardTimeMin,m.waveHardTimeMax),n,i,r,a,A(F.Double,F.Sixtuple),B(..._e))}throw new Error}let Oe,Ie=0,Ue=1,ke=m.waveEasyCount+m.waveMediumCount+m.waveHardCount+1,Le=ie("m");function Xe(e){if(Ie+=m.delta,(Ie>=m.waveEasyTimeMax||e.deadCount==e.entities.length)&&(Ne(e),Ie=0),Ue<ke)for(let t of e.entities)ee(t);else N(e.boss);Le()&&Ne(e)}function Ge(e,t){if(Ue<ke)for(let n of t.entities)te(e,n);else j(e,t.boss)}function Qe(e){return e.entities.filter((e=>!e.dead))}function Ne(e){Ue++;let t=Ee.Easy;Ue>3&&Ue<=6&&(t=Ee.Medium),Ue>6&&(t=Ee.Hard),e.entities=De(t).enemies,e.deadCount=0,Ie=0,Fe(e.player,1)}function je(e,t){e.dead=!0,t.deadCount++}function Je(e,t){const n=Ke($e(e),$e(t)),i=Ke(Ve(e),Ve(t));return null==n||null==i?null:{x:n.x,y:i.x,w:n.y-n.x,h:i.y-i.x}}function $e(e){return{x:e.x,y:e.x+e.w}}function Ve(e){return{x:e.y,y:e.y+e.h}}function Ke(e,t){return e.y<=t.x||t.y<=e.x?null:{x:Math.max(e.x,t.x),y:Math.min(e.y,t.y)}}var Ze;function et(e){e.scene==Oe.Game&&(ze(e.player),Xe(e.enemies),function(e){const t=e.enemies,n=e.player;for(let i of Qe(t)){for(let e of U(n.bullets))null!=Je(i,e)&&(E(e),je(i,t));for(let t of U(i.bullets))null!=Je(n,t)&&0==We(n)&&nt(Oe.Shop,e);null!=Je(n,i)&&nt(Oe.Shop,e)}for(let i of U(t.boss.bullets))null!=Je(n,i)&&0==We(n)&&nt(Oe.Shop,e);for(let e of U(n.bullets))null!=Je(t.boss,e)&&(E(e),t.boss.life--)}(e))}function tt(e,t){t.scene==Oe.Game&&(!function(e,t){m.debug?S(e,t):M(e,t,"assets/cerbere.png");for(let n of t.bullets.bullets)n.isActive&&T(e,n)}(e,t.player),Ge(e,t.enemies))}function nt(e,t){var n;Ae(t.player),n=t.enemies,Ue=1,Ne(n),J(t.enemies.boss),t.scene=e,e==Oe.Shop&&He(!0),e==Oe.Game&&He(!1)}(Ze=Oe||(Oe={}))[Ze.Shop=0]="Shop",Ze[Ze.Game=1]="Game",Ze[Ze.Quest=2]="Quest";let it=m.engineTimeResolution,rt=performance.now(),at=rt;const lt={canvas:g(m.width,m.height,"gameCanvas"),image:w(x)},ot=function(){const e=function(){const e={x:m.playerWidth,dx:0,y:m.height/2,dy:0,w:m.playerWidth,h:m.playerHeight,bullets:_(m.playerBulletsPoolSize,m.playerBulletSpeedX,m.playerBulletSpeedY,m.playerSprayOpen,m.playerBulletWidth,m.playerBulletHeight),bulletsPattern:F.Single,shootSpeed:1,shieldCount:0,money:10};return Re(e.money),e}(),t=function(e){return{entities:De(Ee.Easy).enemies,deadCount:0,boss:Q(),player:e}}(e),n={player:e,enemies:t,scene:Oe.Shop};return ve=n,n}();!function e(t){window.requestAnimationFrame((t=>e(t)));var n=0;t>rt+it&&(n=o((t-rt)/it));for(var i=0;i<n;i++)rt+=it,et(ot);(function({canvas:e}){e.clearRect(0,0,m.width,m.height)})(lt),tt(lt,ot),at=t}(0);