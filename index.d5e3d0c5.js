function e(e){return Math.round(e)}function n(e){return document.getElementById(e)}Math.PI;function d(e,n){const d=[];for(let i=0;i<n;i++)d.push(e());return d}const i={debug:!1,width:960,height:640,playerSpeedX:300,playerSpeedY:300,playerWidth:50,playerHeight:50,playerBulletSpeedX:800,enemyWidth:50,enemyHeight:50,enemyBulletSpeedX:200,enemyBulletSpeedY:50,enemyShootFrequency:1,enemyBulletPoolSize:1e3,bossWidth:150,bossHeight:150,bossRxMin:100,bossRxMax:200,bossRyMin:100,bossRyMax:200,bossSpeed:50,bulletWidth:5,bulletHeight:5,waveEasyCount:3,waveEasyTimeMin:4,waveEasyTimeMax:6,waveEasyAmplitudeMin:10,waveEasyAmplitudeMax:50,waveEasyFrequencyMin:.1,waveEasyFrequencyMax:.25,waveEasyRxMin:100,waveEasyRxMax:200,waveEasyRyMin:100,waveEasyRyMax:200,waveEasySyMin:0,waveEasySyMax:590,waveMediumCount:3,waveMediumTimeMin:4,waveMediumTimeMax:6,waveMediumAmplitudeMin:10,waveMediumAmplitudeMax:50,waveMediumFrequencyMin:.1,waveMediumFrequencyMax:.25,waveMediumRxMin:100,waveMediumRxMax:200,waveMediumRyMin:100,waveMediumRyMax:200,waveMediumSyMin:0,waveMediumSyMax:590,waveHardCount:3,waveHardTimeMin:4,waveHardTimeMax:6,waveHardAmplitudeMin:10,waveHardAmplitudeMax:50,waveHardFrequencyMin:.1,waveHardFrequencyMax:.25,waveHardRxMin:100,waveHardRxMax:200,waveHardRyMin:100,waveHardRyMax:200,waveHardSyMin:0,waveHardSyMax:590,engineTimeResolution:1,epsilon:.1,delta:.001};function u(e,d,i=null){const u=null==i?(f="canvas",document.createElement(f)):n(i);var f;u.width=e,u.height=d;return u.getContext("2d")}function f({canvas:n},{x:d,y:i,w:u,h:f},t="#FF0000"){n&&(n.fillStyle=t),n.fillRect(e(d),e(i),u,f)}function t(){return{x:0,y:0,w:i.bulletWidth,h:i.bulletHeight,dx:0,dy:0,isActive:!1}}function a(e){e.isActive&&(e.x+=e.dx*i.delta,e.y+=e.dy*i.delta)}function r(e,n){n.isActive&&f(e,n)}function l(e,n,d){e.x=n.x,e.y=n.y,e.dx=d.x,e.dy=d.y,e.isActive=!0}function o(e){e.isActive=!1,e.dx=0,e.dy=0,e.x=0,e.y=0}let y;var s;function M(...e){return e[Math.floor(Math.random()*e.length)]}function c(e,n){return Math.random()*(n-e)+e}function h(e,n){return e=Math.ceil(e),n=Math.floor(n),Math.floor(Math.random()*(n-e)+e)}function x(){return Math.floor(16777215*Math.random()).toString(16)}function w(e,n){return{x:e,y:n}}function v(e,n){return w(e.x+n.x,e.y+n.y)}let m;var p;let g;var R;function H(e,n,u,f,a,r,l,o,s=BulletPatternSingle){return{x:i.width,y:e,sy:e,dx:0,dy:0,w:i.enemyWidth,h:i.enemyHeight,pattern:n,time:f,color:u,dead:!1,amplitude:a,frequency:r,rx:l,ry:o,elapsedTime:0,shootElapsedTime:0,distance:0,bullets:d((()=>t()),50),direction:y.Left,bulletPattern:s}}let S;var b;function E(e){const n=[];if(e==S.Easy){const d=h(3,6);for(let i=0;i<d;i++)n.push(T(e))}if(e==S.Medium){const d=h(5,10);for(let i=0;i<d;i++)n.push(T(e))}if(e==S.Hard){const d=h(9,17);for(let i=0;i<d;i++)n.push(T(e))}return{difficulty:e,enemies:n}}function T(e){const n=`#${x()}`;if(e==S.Easy){const e=M(m.Straight,m.Triangular),d=c(i.waveEasyAmplitudeMin,i.waveEasyAmplitudeMax),u=c(i.waveEasyFrequencyMin,i.waveEasyFrequencyMax),f=c(i.waveEasyRxMin,i.waveEasyRxMax),t=c(i.waveEasyRyMin,i.waveEasyRyMax);return H(c(i.waveEasySyMin,i.waveEasySyMax),e,n,c(i.waveEasyTimeMin,i.waveEasyTimeMax),d,u,f,t,h(g.Single,g.Double+1))}if(e==S.Medium){const e=M(m.Straight,m.Triangular,m.Rectangular),d=c(i.waveMediumAmplitudeMin,i.waveMediumAmplitudeMax),u=c(i.waveMediumFrequencyMin,i.waveMediumFrequencyMax),f=c(i.waveMediumRxMin,i.waveMediumRxMax),t=c(i.waveMediumRyMin,i.waveMediumRyMax);return H(c(i.waveMediumSyMin,i.waveMediumSyMax),e,n,c(i.waveMediumTimeMin,i.waveMediumTimeMax),d,u,f,t,h(g.Single,g.Triple+1))}if(e==S.Hard){const e=M(m.Triangular,m.Rectangular,m.Circular),d=c(i.waveHardAmplitudeMin,i.waveHardAmplitudeMax),u=c(i.waveHardFrequencyMin,i.waveHardFrequencyMax),f=c(i.waveHardRxMin,i.waveHardRxMax),t=c(i.waveHardRyMin,i.waveHardRyMax);return H(c(i.waveHardSyMin,i.waveHardSyMax),e,n,c(i.waveHardTimeMin,i.waveHardTimeMax),d,u,f,t,h(g.Double,g.Triple+1))}throw new Error}(s=y||(y={}))[s.Up=0]="Up",s[s.Left=1]="Left",s[s.Right=2]="Right",s[s.Down=3]="Down",(p=m||(m={}))[p.Straight=0]="Straight",p[p.Triangular=1]="Triangular",p[p.Circular=2]="Circular",p[p.Rectangular=3]="Rectangular",(R=g||(g={}))[R.Single=0]="Single",R[R.Double=1]="Double",R[R.Triple=2]="Triple",(b=S||(S={}))[b.Easy=0]="Easy",b[b.Medium=1]="Medium",b[b.Hard=2]="Hard";let A=0,F=1;function q(e){F++;let n=S.Easy;F>3&&F<=6&&(n=S.Medium),F>6&&(n=S.Hard),e.entities=E(n).enemies,e.deadCount=0,A=0}function C(e){F=1,q(e)}function W(e,n){e.dead=!0,n.deadCount++}const D={up:!1,down:!1,left:!1,right:!1,space:!1,shift:!1};function B(e){let n=!0;return()=>D[e]&&n?(n=!1,!0):(D[e]||(n=!0),!1)}onkeydown=onkeyup=e=>function(e,n){38!=e&&90!=e&&87!=e||(D.up=n);39!=e&&68!=e||(D.right=n);40!=e&&83!=e||(D.down=n);37!=e&&65!=e&&81!=e||(D.left=n);16==e&&(D.shift=n);32==e&&(D.space=n)}(e.keyCode,null!=e.type[5]);let L,P,U=null,X=(...e)=>{let n=U.createBufferSource(),d=U.createBuffer(e.length,e[0].length,k);return e.map(((e,n)=>d.getChannelData(n).set(e))),n.buffer=d,n.connect(U.destination),n.start(),n},I=(e=1,n=.05,d=220,i=0,u=0,f=.1,t=0,a=1,r=0,l=0,o=0,y=0,s=0,M=0,c=0,h=0,x=0,w=1,v=0,m=0)=>{let p,g,R=2*Math.PI,H=r*=500*R/k**2,S=(0<c?1:-1)*R/4,b=d*=(1+2*n*Math.random()-n)*R/k,E=[],T=0,A=0,F=0,q=1,C=0,W=0,D=0;for(l*=500*R/k**3,c*=R/k,o*=R/k,y*=k,s=k*s|0,g=(i=99+k*i)+(v*=k)+(u*=k)+(f*=k)+(x*=k)|0;F<g;E[F++]=D)++W%(100*h|0)||(D=t?1<t?2<t?3<t?Math.sin((T%R)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/R%2+2)%2:1-4*Math.abs(Math.round(T/R)-T/R):Math.sin(T),D=(s?1-m+m*Math.sin(2*Math.PI*F/s):1)*(0<D?1:-1)*Math.abs(D)**a*e*Y*(F<i?F/i:F<i+v?1-(F-i)/v*(1-w):F<i+v+u?w:F<g-x?(g-F-x)/f*w:0),D=x?D/2+(x>F?0:(F<g-x?1:(g-F)/x)*E[F-x|0]/2):D),p=(d+=r+=l)*Math.sin(A*c-S),T+=p-p*M*(1-1e9*(Math.sin(F)+1)%2),A+=p-p*M*(1-1e9*(Math.sin(F)**2+1)%2),q&&++q>y&&(d+=o,b+=o,q=0),!s||++C%s||(d=b,r=H,q=q||1);return E},Y=.3,k=44100,$=[[[.5,0,196,.05,.5,.6,1],[.8,undefined,24.5,.2,.3,.7,undefined,.5,undefined,undefined,5,undefined,.1,undefined,undefined,undefined,undefined,.8,undefined,.2],[2,0,196,.02,.1,.4,1],[,0,49,undefined,undefined,.2,3,5]],[[[,-1,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,1,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,12,undefined,undefined,undefined,undefined,undefined,undefined,undefined,17,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,undefined,3,undefined,undefined,undefined,undefined,undefined,undefined,undefined,5,undefined,undefined,undefined,undefined,undefined,undefined,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[2,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,15,15,undefined,13,undefined,10,undefined]],[[,-1,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,1,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,12,undefined,undefined,undefined,undefined,undefined,undefined,undefined,17,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,undefined,3,undefined,undefined,undefined,undefined,undefined,undefined,undefined,5,undefined,undefined,undefined,undefined,undefined,undefined,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[2,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,3,undefined,3,undefined,10,undefined,undefined,undefined,8,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,15,15,undefined,13,undefined,10,undefined],[3,undefined,8,undefined,undefined,undefined,8,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,undefined,3,undefined,undefined,15,15,undefined,13,undefined,10,undefined]],[[,-1,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,1,10,undefined,undefined,undefined,undefined,undefined,undefined,undefined,12,undefined,undefined,undefined,undefined,undefined,undefined,undefined,17,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[,undefined,3,undefined,undefined,undefined,undefined,undefined,undefined,undefined,5,undefined,undefined,undefined,undefined,undefined,undefined,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined],[2,undefined,8,undefined,undefined,undefined,undefined,undefined,undefined,undefined,3,undefined,3,undefined,10,undefined,undefined,undefined,8,undefined,6,undefined,undefined,undefined,undefined,undefined,undefined,15,15,undefined,13,undefined,10,undefined],[3,undefined,8,undefined,undefined,undefined,8,undefined,10,undefined,undefined,undefined,1,3,undefined,undefined,8,undefined,1,3,undefined,undefined,1,undefined,3,undefined,undefined,15,15,undefined,13,undefined,10,undefined]]],[0,1,2,1,2],110,undefined];function z(){U=new window.AudioContext,L=((e,n,d,i=125)=>{let u,f,t,a,r,l,o,y,s,M,c,h,x,w,v,m=0,p=[],g=[],R=[],H=0,S=0,b=1,E={},T=k/i*60>>2;for(;b;H++)p=[b=y=c=x=0],d.map(((i,c)=>{for(o=n[i][H]||[0,0,0],b|=!!n[i][H],v=x+(n[i][0].length-2-!y)*T,w=c==d.length-1,f=2,a=x;f<o.length+w;y=++f){for(r=o[f],s=f==o.length+w-1&&w||M!=(o[0]||0)|r|0,t=0;t<T&&y;t++>T-99&&s&&(h+=(h<1)/99))l=(1-h)*p[m++]/2||0,g[a]=(g[a]||0)-l*S+l,R[a]=(R[a++]||0)+l*S+l;r&&(h=r%1,S=o[1]||0,(r|=0)&&(p=E[[M=o[m=0]||0,r]]=E[[M,r]]||(u=[...e[M]],u[2]*=2**((r-12)/12),r>0?I(...u):[])))}x=v}));return[g,R]})(...$)}const j=B("space"),G=B("shift");let J=w(i.playerWidth,i.playerHeight/2),K=!1,N=!1;function O(e){let n=0,d=0;D.left&&(n+=-i.playerSpeedX),D.right&&(n+=i.playerSpeedX),D.up&&(d+=-i.playerSpeedY),D.down&&(d+=i.playerSpeedY),j()&&function(e){let n=e.bullets.find((e=>!e.isActive));null!=n&&l(n,v(e,J),w(i.playerBulletSpeedX,0))}(e),e.dx=n,e.dy=d,N||(z(),N=!0),N&&G()&&(K?P.stop():(U?.resume(),P=X(...L),P.loop=!0),K=!K),e.x+=e.dx*i.delta,e.y+=e.dy*i.delta,e.x<=0&&(e.x=0),e.x>=i.width-i.playerWidth&&(e.x=i.width-i.playerWidth),e.y<=0&&(e.y=0),e.y>=i.height-i.playerHeight&&(e.y=i.height-i.playerHeight),function(e){for(let n of e)a(n)}(e.bullets)}function Q(e){e.x=i.playerWidth,e.y=i.height/2,e.dx=0,e.dy=0}function V(e,n){const d=ee(Z(e),Z(n)),i=ee(_(e),_(n));return null==d||null==i?null:{x:d.x,y:i.x,w:d.y-d.x,h:i.y-i.x}}function Z(e){return{x:e.x,y:e.x+e.w}}function _(e){return{x:e.y,y:e.y+e.h}}function ee(e,n){return e.y<=n.x||n.y<=e.x?null:{x:Math.max(e.x,n.x),y:Math.min(e.y,n.y)}}let ne=i.engineTimeResolution,de=performance.now(),ie=de;const ue={x:i.playerWidth,dx:0,y:i.height/2,dy:0,w:i.playerWidth,h:i.playerHeight,bullets:d((()=>t()),50)},fe=function(){const e=`#${x()}`;return{x:.75*i.width,y:.5*i.height,w:i.bossWidth,h:i.bossHeight,dx:0,dy:0,distance:0,color:e,direction:y.Left,bullets:d((()=>t()),100),rx:c(i.bossRxMin,i.bossRxMax),ry:c(i.bossRyMin,i.bossRyMax)}}(),te={entities:E(S.Easy).enemies,deadCount:0},ae={canvas:u(i.width,i.height,"gameCanvas")};function re(){O(ue),function(e){for(let n of e.bullets)a(n);const n=i.bossSpeed;null==e.direction&&(e.direction=y.Left),e.direction==y.Left&&(e.distance>=e.rx&&(e.direction=M(y.Up,y.Down,y.Right),e.distance=0),e.dx=-n,e.dy=0,e.distance+=-e.dx*i.delta),e.direction==y.Right&&(e.distance>=e.rx&&(e.direction=M(y.Up,y.Down,y.Left),e.distance=0),e.dx=n,e.dy=0,e.distance+=e.dx*i.delta),e.direction==y.Up&&(e.distance>=e.ry&&(e.direction=M(y.Right,y.Down,y.Left),e.distance=0),e.dy=-n/2,e.dx=0,e.distance+=-e.dy*i.delta),e.direction==y.Down&&(e.distance>=e.ry&&(e.direction=M(y.Right,y.Up,y.Left),e.distance=0),e.dy=n/2,e.dx=0,e.distance+=e.dy*i.delta),e.x+=e.dx*i.delta,e.y+=e.dy*i.delta}(fe),function(e,n){for(let d of function(e){return e.entities.filter((e=>!e.dead))}(n)){for(let i of e.bullets)null!=V(d,i)&&(o(i),W(d,n));for(let i of d.bullets)null!=V(e,i)&&(C(n),Q(e));null!=V(e,d)&&(Q(e),C(n))}}(ue,te)}!function e(n){window.requestAnimationFrame((n=>e(n)));var d,u=0;n>de+ne&&(d=(n-de)/ne,u=Math.floor(d));for(var t=0;t<u;t++)de+=ne,re();(function({canvas:e}){e.clearRect(0,0,i.width,i.height)})(ae),function(e,n){f(e,n);for(let d of n.bullets)d.isActive&&r(e,d)}(ae,ue),function(e,n){for(let d of n.bullets)r(e,d);f(e,n,n.color)}(ae,fe),ie=n}(0);